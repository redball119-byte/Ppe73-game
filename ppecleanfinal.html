<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>í™˜ê²½ê´€ë¦¬ë‹´ë‹¹ì ë³´í˜¸êµ¬ êµìœ¡</title>
  <style>
    :root{
      --bg1:#071022;
      --bg2:#050a14;
      --card: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.12);
      --text:#eaf0ff;
      --muted: rgba(234,240,255,.68);
      --good:#22c55e;
      --bad:#ff4d4f;
      --shadow: 0 18px 40px rgba(0,0,0,.35);
      --r: 22px;
    }

    *{box-sizing:border-box}
    html, body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", Segoe UI, Roboto, sans-serif;
      background: radial-gradient(1200px 700px at 20% 0%, #0a1b3a 0%, var(--bg1) 40%, var(--bg2) 100%);
      overflow:hidden; /* ìŠ¤í¬ë¡¤ë¡œ ë ˆì´ì•„ì›ƒ ê¹¨ì§€ëŠ”ê±° ë°©ì§€ */
      -webkit-tap-highlight-color: transparent;
    }

    .app{
      min-height:100dvh;
      padding: calc(12px + env(safe-area-inset-top)) 12px calc(12px + env(safe-area-inset-bottom));
      display:flex;
      flex-direction:column;
      gap:12px;
      max-width: 520px;
      margin: 0 auto;
    }

    .card{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
    }

    /* âœ… ìƒë‹¨ì„ "ê°€ë¡œ 1ì¤„"ë¡œ ë‚®ê²Œ */
    .topbar{
      display:flex;
      align-items:stretch;
      gap:10px;
    }
    .top-left{
      flex: 1 1 auto;
      padding: 12px 14px;
      display:flex;
      gap:10px;
      align-items:center;
      min-height: 64px;
    }
    .broom{
      font-size: 20px;
      filter: drop-shadow(0 6px 12px rgba(0,0,0,.35));
    }
    .title-wrap{
      display:flex;
      flex-direction:column;
      line-height:1.15;
      gap:4px;
      min-width:0;
    }
    .title{
      font-weight: 900;
      letter-spacing: -.02em;
      font-size: clamp(16px, 4.4vw, 20px);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .subtitle{
      color: var(--muted);
      font-size: 12px;
    }

    .top-right{
      flex: 0 0 150px;
      padding: 10px 12px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:6px;
      min-height: 64px;
      text-align:center;
    }
    .meta{
      display:flex;
      justify-content:space-between;
      gap:8px;
      font-size: 12px;
      color: var(--muted);
    }
    .meta strong{color:var(--text); font-size: 14px}

    .restart{
      flex: 0 0 72px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight: 800;
      border-radius: var(--r);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.05);
      cursor:pointer;
      user-select:none;
    }
    .restart:active{transform: scale(.98)}

    /* ì•ˆë‚´ */
    .guide{
      padding: 12px 14px;
      line-height:1.35;
      font-size: 13px;
      color: var(--muted);
    }
    .guide b{color:var(--text)}

    /* íƒ€ì´ë¨¸/ìƒíƒœ */
    .statusbar{
      display:flex;
      gap:10px;
      align-items:stretch;
    }
    .pill{
      flex:1 1 50%;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size: 13px;
      color: var(--muted);
      min-height: 44px;
    }
    .pill strong{color:var(--text); font-size: 16px}
    .pill .badge{
      font-weight: 900;
      letter-spacing:.02em;
      color: var(--text);
    }

    /* âœ… ë‚™í•˜ ì˜ì—­: ë‚¨ëŠ” ë†’ì´ë¥¼ ìµœëŒ€í•œ ë¨¹ê³ , ì•„ë˜ ì„ íƒì§€ëŠ” í™”ë©´ ì•ˆì— ê³ ì • */
    .main{
      flex: 1 1 auto;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height: 0; /* ì¤‘ìš”: flex overflow ë°©ì§€ */
    }

    .fall-area{
      flex: 1 1 auto;
      min-height: 200px;
      padding: 14px;
      position:relative;
      overflow:hidden;
    }
    .fall-box{
      position:relative;
      width:100%;
      height:100%;
      border-radius: calc(var(--r) - 6px);
      border: 2px dashed rgba(255,255,255,.18);
      background: rgba(0,0,0,.08);
    }

    .fall-text{
      position:absolute;
      left: 50%;
      transform: translateX(-50%);
      top: 12px;
      padding: 14px 16px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      box-shadow: 0 14px 30px rgba(0,0,0,.35);
      font-weight: 900;
      text-align:center;
      max-width: calc(100% - 22px);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: clamp(18px, 5.4vw, 28px);
      letter-spacing: -.02em;
    }

    /* ì„ íƒ ì˜ì—­ */
    .choices{
      padding: 14px;
    }
    .choices-head{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      margin-bottom: 12px;
      gap:10px;
    }
    .choices-head .h{
      font-weight: 900;
      font-size: 16px;
      letter-spacing: -.02em;
    }
    .choices-head .hint{
      color: var(--muted);
      font-size: 12px;
      white-space: nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }

    .btn{
      border-radius: 18px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      box-shadow: 0 14px 28px rgba(0,0,0,.25);
      padding: 14px 12px;
      text-align:center;
      cursor:pointer;
      user-select:none;
      min-height: 70px; /* âœ… í™”ë©´ ì•„ë˜ê°€ ì˜ë ¤ë„ ë²„íŠ¼ ìµœì†Œ ë³´ì´ê²Œ */
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:6px;
    }
    .btn:active{transform: scale(.985)}
    .btn .big{
      font-weight: 900;
      font-size: clamp(18px, 5vw, 22px);
      letter-spacing: -.02em;
    }
    .btn .small{
      color: var(--muted);
      font-size: 12px;
      line-height:1.15;
    }

    .footer-note{
      margin-top: 10px;
      color: var(--muted);
      text-align:center;
      font-size: 12px;
    }

    /* ê²°ê³¼ í† ìŠ¤íŠ¸ */
    .toast{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(16px + env(safe-area-inset-bottom));
      background: rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.18);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 999px;
      box-shadow: 0 18px 40px rgba(0,0,0,.45);
      font-weight: 800;
      font-size: 13px;
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      max-width: calc(100vw - 28px);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(-2px);
    }

    /* ì‘ì€ í™”ë©´(ê°€ë¡œí­/ë†’ì´ ê·¹ë‹¨) ëŒ€ì‘ */
    @media (max-height: 720px){
      .guide{display:none;} /* âœ… ê³µê°„ í™•ë³´: ì•ˆë‚´ì¹´ë“œ ìˆ¨ê¹€ */
      .btn{min-height: 64px; padding: 12px 10px;}
      .choices{padding: 12px}
      .fall-area{padding: 12px}
    }
    @media (max-height: 630px){
      .statusbar{display:none;} /* âœ… ë” ì‘ìœ¼ë©´ ìƒíƒœë°”ë„ ìˆ¨ê²¨ì„œ ë³´í˜¸êµ¬ê°€ ì ˆëŒ€ ì•ˆ ì§¤ë¦¬ê²Œ */
      .top-right{flex-basis: 140px;}
    }
  </style>
</head>

<body>
  <div class="app">
    <!-- âœ… ìƒë‹¨ 1ì¤„ -->
    <div class="topbar">
      <div class="top-left card">
        <div class="broom">ğŸ§¹</div>
        <div class="title-wrap">
          <div class="title">í™˜ê²½ê´€ë¦¬ë‹´ë‹¹ì ë³´í˜¸êµ¬ êµìœ¡</div>
          <div class="subtitle">ë‚™í•˜ í€´ì¦ˆ</div>
        </div>
      </div>

      <div class="restart" id="btnRestart" title="ì¬ì‹œì‘">â†»</div>

      <div class="top-right card">
        <div class="meta"><span>ë¬¸í•­</span><strong id="qCount">1/5</strong></div>
        <div class="meta"><span>ì ìˆ˜</span><strong id="score">0</strong></div>
      </div>
    </div>

    <!-- ì•ˆë‚´(ì‘ì€ í™”ë©´ì—ì„œëŠ” ìë™ ìˆ¨ê¹€) -->
    <div class="guide card">
      <b>ì§ˆë³‘/ìƒí™©</b>ì´ ë°•ìŠ¤ ì•ˆì—ì„œ ì•„ë˜ë¡œ <b>5ì´ˆ</b> ë™ì•ˆ ë‚´ë ¤ì˜µë‹ˆë‹¤. ì•„ë˜ì—ì„œ <b>PPE 1ê°œ</b>ë¥¼ ì„ íƒí•˜ë©´ ìë™ ì±„ì  í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.
    </div>

    <!-- ìƒíƒœ -->
    <div class="statusbar">
      <div class="pill">
        <span>â³ ì œí•œì‹œê°„</span>
        <strong id="timeLeft">5.0s</strong>
      </div>
      <div class="pill">
        <span>ìƒíƒœ</span>
        <span class="badge" id="state">ì§„í–‰</span>
      </div>
    </div>

    <div class="main">
      <!-- âœ… ë‚™í•˜ ì˜ì—­(í¬ê²Œ) -->
      <div class="fall-area card">
        <div class="fall-box" id="fallBox">
          <div class="fall-text" id="fallText">ì¤€ë¹„ ì¤‘â€¦</div>
        </div>
      </div>

      <!-- âœ… ë³´í˜¸êµ¬(í•­ìƒ í™”ë©´ ì•ˆ) -->
      <div class="choices card">
        <div class="choices-head">
          <div class="h">ë³´í˜¸êµ¬ ì„ íƒ (4ê°œ)</div>
          <div class="hint">í•œ ë¬¸ì œë‹¹ 1ê°œë§Œ ì„ íƒ</div>
        </div>

        <div class="grid">
          <div class="btn" data-choice="mask">
            <div class="big">ë§ˆìŠ¤í¬</div>
            <div class="small">ê¸°ë³¸(ë¹„ë§/ë¶„ë¬´)</div>
          </div>
          <div class="btn" data-choice="n95">
            <div class="big">N95</div>
            <div class="small">ê³µê¸°(ê²°í•µ ë“±)</div>
          </div>
          <div class="btn" data-choice="gown_gloves">
            <div class="big">ê°€ìš´+ì¥ê°‘</div>
            <div class="small">ì ‘ì´‰(ì˜¤ì—¼ë¬¼ ì²˜ë¦¬)</div>
          </div>
          <div class="btn" data-choice="none">
            <div class="big">ë³´í˜¸êµ¬ ë¶ˆí•„ìš”</div>
            <div class="small">ìœ„í—˜ ë‚®ìŒ(êµìœ¡ìš©)</div>
          </div>
        </div>

        <div class="footer-note" id="footerNote">ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.</div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">ê²°ê³¼</div>

  <script>
    // âœ… ë¬¸ì œ(ì›í•˜ë©´ ì—¬ê¸°ë§Œ ëŠ˜ë¦¬ë©´ ë¨)
    // answer: mask | n95 | gown_gloves | none
    const QUESTIONS = [
      { text: "ì¸í”Œë£¨ì—”ì í™˜ì êµ¬ì—­ ì²­ì†Œ", answer: "mask" },
      { text: "ê²°í•µ ì˜ì‹¬ í™˜ì ê²©ë¦¬ì‹¤ ì²­ì†Œ", answer: "n95" },
      { text: "VRE/CRE ì¥ê¸° ì¬ì‹¤ ë³‘ì‹¤ í‡´ì‹¤ í›„ í„°ë¯¸ë„ ì²­ì†Œ", answer: "gown_gloves" },
      { text: "ì¼ë°˜ ë³µë„ ì²­ì†Œ", answer: "none" },
      { text: "í˜ˆì•¡/ì²´ì•¡ ì˜¤ì—¼ë¬¼ ì²˜ë¦¬(ìŠ¤í•„)", answer: "gown_gloves" },
    ];

    const FALL_SECONDS = 5.0;

    const elQCount = document.getElementById("qCount");
    const elScore  = document.getElementById("score");
    const elTime   = document.getElementById("timeLeft");
    const elState  = document.getElementById("state");
    const elText   = document.getElementById("fallText");
    const elBox    = document.getElementById("fallBox");
    const elToast  = document.getElementById("toast");
    const btnRestart = document.getElementById("btnRestart");

    let idx = 0;
    let score = 0;
    let running = false;
    let answered = false;

    let startTS = 0;
    let rafId = 0;

    function showToast(msg){
      elToast.textContent = msg;
      elToast.classList.add("show");
      setTimeout(() => elToast.classList.remove("show"), 900);
    }

    function setState(text, kind){
      elState.textContent = text;
      if(kind === "good") elState.style.color = "var(--good)";
      else if(kind === "bad") elState.style.color = "var(--bad)";
      else elState.style.color = "var(--text)";
    }

    function resetFallPosition(){
      elText.style.top = "12px";
    }

    function nextQuestion(){
      idx++;
      if(idx >= QUESTIONS.length){
        // ë
        running = false;
        answered = true;
        setState("ì™„ë£Œ", "good");
        elTime.textContent = "0.0s";
        showToast(`ë! ì ìˆ˜ ${score}/${QUESTIONS.length}`);
        return;
      }
      startRound();
    }

    function startRound(){
      answered = false;
      running = true;
      setState("ì§„í–‰", null);

      const q = QUESTIONS[idx];
      elText.textContent = q.text;
      elQCount.textContent = `${idx+1}/${QUESTIONS.length}`;
      elScore.textContent = `${score}`;
      elTime.textContent = `${FALL_SECONDS.toFixed(1)}s`;

      resetFallPosition();
      startTS = performance.now();
      cancelAnimationFrame(rafId);
      rafId = requestAnimationFrame(tick);
    }

    function tick(ts){
      if(!running) return;

      const elapsed = (ts - startTS) / 1000;
      const left = Math.max(0, FALL_SECONDS - elapsed);
      elTime.textContent = `${left.toFixed(1)}s`;

      // ë°•ìŠ¤ ë†’ì´ì— ë§ì¶° ì•„ë˜ë¡œ ì´ë™ (í…ìŠ¤íŠ¸ê°€ ë°•ìŠ¤ ì•ˆì—ì„œ ë‚´ë ¤ì˜¤ë„ë¡)
      const boxH = elBox.clientHeight;
      const textH = elText.offsetHeight;
      const topStart = 12;
      const topEnd = Math.max(12, boxH - textH - 14);

      const p = Math.min(1, elapsed / FALL_SECONDS);
      const y = topStart + (topEnd - topStart) * p;
      elText.style.top = `${y}px`;

      if(elapsed >= FALL_SECONDS && !answered){
        // ì‹œê°„ì´ˆê³¼ = ì˜¤ë‹µ ì²˜ë¦¬
        answered = true;
        setState("ì˜¤ë‹µ", "bad");
        const correct = QUESTIONS[idx].answer;
        showToast(`ì‹œê°„ì´ˆê³¼ âœ•  ì •ë‹µ: ${labelOf(correct)}`);
        setTimeout(nextQuestion, 650);
        return;
      }

      rafId = requestAnimationFrame(tick);
    }

    function labelOf(choice){
      switch(choice){
        case "mask": return "ë§ˆìŠ¤í¬";
        case "n95": return "N95";
        case "gown_gloves": return "ê°€ìš´+ì¥ê°‘";
        case "none": return "ë³´í˜¸êµ¬ ë¶ˆí•„ìš”";
        default: return choice;
      }
    }

    function choose(choice){
      if(!running || answered) return;
      answered = true;

      const correct = QUESTIONS[idx].answer;
      if(choice === correct){
        score++;
        elScore.textContent = `${score}`;
        setState("ì •ë‹µ", "good");
        showToast(`ì •ë‹µ âœ“`);
      }else{
        setState("ì˜¤ë‹µ", "bad");
        showToast(`ì˜¤ë‹µ âœ•  ì •ë‹µ: ${labelOf(correct)}`);
      }

      setTimeout(nextQuestion, 520);
    }

    // ë²„íŠ¼ ì´ë²¤íŠ¸
    document.querySelectorAll(".btn").forEach(b=>{
      b.addEventListener("click", ()=> choose(b.dataset.choice));
    });

    // ì¬ì‹œì‘
    function restart(){
      idx = 0;
      score = 0;
      running = true;
      answered = false;
      startRound();
      showToast("ì¬ì‹œì‘");
    }
    btnRestart.addEventListener("click", restart);

    // ì‹œì‘
    restart();

    // í™”ë©´ íšŒì „/í¬ê¸° ë³€í™” ì‹œ ìœ„ì¹˜ ì•ˆì •í™”
    window.addEventListener("resize", ()=> {
      if(!running) return;
      resetFallPosition();
      startTS = performance.now();
    });
  </script>
</body>
</html>
