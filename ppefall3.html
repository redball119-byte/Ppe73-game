<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ</title>
  <style>
    :root{
      --bg:#071022;
      --card: rgba(255,255,255,.07);
      --stroke: rgba(255,255,255,.10);
      --text:#eef4ff;
      --muted: rgba(238,244,255,.72);
      --good:#22c55e;
      --bad:#ef4444;
      --shadow: 0 18px 40px rgba(0,0,0,.45);
      --r: 22px;
    }
    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif;
      background: radial-gradient(1200px 800px at 15% 0%, rgba(255,255,255,.08), transparent 55%),
                  radial-gradient(900px 600px at 90% 10%, rgba(34,197,94,.08), transparent 55%),
                  var(--bg);
      color: var(--text);
      overflow:hidden; /* ì•±í˜•: ì•„ë˜ ë³´í˜¸êµ¬ ì˜ì—­ ê³ ì •ì‹œí‚¤ê¸° ìœ„í•´ body ìŠ¤í¬ë¡¤ ë§‰ìŒ */
    }

    /* ì•± ì „ì²´ ë ˆì´ì•„ì›ƒ: ìœ„ëŠ” ìŠ¤í¬ë¡¤ ê°€ëŠ¥ / ì•„ë˜(ë³´í˜¸êµ¬)ëŠ” ê³ ì • */
    .app{
      height: 100dvh;
      display:flex;
      flex-direction:column;
      padding: 14px 14px calc(14px + env(safe-area-inset-bottom));
      gap: 12px;
    }
    .top-scroll{
      flex: 1 1 auto;
      overflow:auto;
      padding-bottom: 10px;
    }

    .row{
      display:grid;
      grid-template-columns: 1.25fr .75fr .75fr;
      gap: 12px;
      margin-bottom:12px;
    }
    .card{
      background: var(--card);
      border:1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
    }
    .head{
      padding: 14px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      min-height: 86px;
    }
    .title{
      display:flex; gap:10px; align-items:flex-start;
    }
    .emoji{ font-size: 18px; line-height:1; margin-top:2px; opacity:.9; }
    .t1{ font-weight: 800; font-size: 20px; letter-spacing:-.02em; }
    .t2{ margin-top:6px; font-size: 12px; color: var(--muted); }
    .pillBtn{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 999px;
      padding: 10px 12px;
      font-weight: 700;
      font-size: 13px;
      display:flex; align-items:center; gap:8px;
      cursor:pointer;
    }
    .pillBtn:active{ transform: translateY(1px); }

    .stat{
      padding: 12px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      min-height: 86px;
    }
    .stat .k{ font-size: 13px; color: var(--muted); }
    .stat .v{ font-size: 34px; font-weight: 900; letter-spacing:-.03em; margin-top:4px; }

    .inst{
      padding: 14px 14px 10px;
      margin-bottom: 12px;
    }
    .inst .h{
      font-size: 18px;
      font-weight: 900;
      letter-spacing:-.02em;
      margin:0 0 8px;
    }
    .inst .s{
      margin:0;
      font-size: 13px;
      line-height:1.5;
      color: var(--muted);
    }

    .statusBar{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 12px;
    }
    .chip{
      padding: 12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      min-height: 52px;
    }
    .chip .l{
      display:flex; align-items:center; gap: 8px;
      color: var(--muted);
      font-weight: 700;
      font-size: 13px;
    }
    .chip .r{
      font-weight: 900;
      font-size: 16px;
    }

    /* ë¬¸ì œ(ë‚™í•˜) ì˜ì—­ */
    .dropWrap{
      padding: 14px;
      margin-bottom: 10px;
    }
    .dropArea{
      position: relative;
      height: min(34vh, 300px); /* í•µì‹¬: ë„ˆë¬´ ì‘ì§€ ì•Šê²Œ, ë„ˆë¬´ í¬ì§€ë„ ì•Šê²Œ */
      min-height: 220px;
      border-radius: calc(var(--r) + 6px);
      border: 2px dashed rgba(255,255,255,.18);
      background: rgba(0,0,0,.12);
      overflow:hidden;
    }
    .fallItem{
      position:absolute;
      left: 50%;
      transform: translateX(-50%);
      top: -72px;
      width: min(92%, 520px);
      background: rgba(255,255,255,.07);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 18px;
      padding: 14px 14px;
      text-align:center;
      font-weight: 900;
      font-size: clamp(18px, 5vw, 26px); /* ì§ˆë³‘ ê¸€ì”¨: ìë™ìœ¼ë¡œ ì¤„ì–´ë“¤ë„ë¡ */
      letter-spacing: -.03em;
      box-shadow: 0 14px 30px rgba(0,0,0,.45);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .falling{
      animation: fall linear forwards;
    }
    @keyframes fall{
      from{ top: -72px; }
      to{ top: calc(100% - 84px); } /* ì•„ë˜ ë”± ë¶™ì–´ì„œ ì•ˆ ì˜ë¦¬ê²Œ */
    }

    /* ê²°ê³¼ ë°°ë„ˆ: ê¸¸ê²Œ ì„¤ëª… X, ì§§ê²Œë§Œ */
    .banner{
      position:absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 12px;
      width: min(92%, 520px);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 900;
      text-align:center;
      display:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.30);
    }
    .banner.good{ color: var(--good); }
    .banner.bad{ color: var(--bad); }
    .banner.show{ display:block; }

    /* ì•„ë˜ ë³´í˜¸êµ¬: í•­ìƒ í™”ë©´ ì•„ë˜ ê³ ì • */
    .bottomFixed{
      flex: 0 0 auto;
      padding: 12px;
      border-radius: var(--r);
      background: rgba(255,255,255,.05);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
    }
    .pickHeader{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      margin-bottom:10px;
      gap: 10px;
    }
    .pickHeader .h{
      font-size: 18px;
      font-weight: 900;
      margin:0;
      letter-spacing:-.02em;
    }
    .pickHeader .sub{
      font-size: 12px;
      color: var(--muted);
      font-weight: 700;
      white-space:nowrap;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .opt{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.12);
      padding: 14px 12px;
      cursor:pointer;
      text-align:center;
      user-select:none;
    }
    .opt:active{ transform: translateY(1px); }
    .opt .t{
      font-weight: 900;
      font-size: 16px;
      letter-spacing:-.02em;
      margin-bottom: 6px;
    }
    .opt .d{
      font-size: 12px;
      color: var(--muted);
      font-weight: 700;
    }
    .opt.disabled{
      opacity: .55;
      pointer-events:none;
    }

    /* ì‘ì€ í™”ë©´ì—ì„œ ë” ì´˜ì´˜í•˜ê²Œ */
    @media (max-height: 720px){
      .head{ min-height: 78px; padding: 12px; }
      .stat{ min-height: 78px; }
      .stat .v{ font-size: 30px; }
      .dropArea{ min-height: 210px; }
      .opt{ padding: 12px 10px; }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="top-scroll">
      <div class="row">
        <div class="card head">
          <div class="title">
            <div class="emoji">ğŸ§¹</div>
            <div>
              <div class="t1">í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ</div>
              <div class="t2">ê¸°ë³¸ 4ì¢… Â· ì§ˆë³‘ëª… ë‚™í•˜</div>
            </div>
          </div>
          <button id="restartBtn" class="pillBtn" type="button" aria-label="ì¬ì‹œì‘">
            â†» ì¬ì‹œì‘
          </button>
        </div>

        <div class="card stat">
          <div class="k">ë¬¸í•­</div>
          <div class="v"><span id="qNow">1</span>/<span id="qTotal">10</span></div>
        </div>

        <div class="card stat">
          <div class="k">ì ìˆ˜</div>
          <div class="v" style="font-size:32px;"><span id="score">0</span></div>
        </div>
      </div>

      <div class="card inst">
        <p class="h">ì§ˆë³‘/ìƒí™©ì„ ë³´ê³  í•„ìš”í•œ PPE 1ê°œë¥¼ ê³ ë¥´ì„¸ìš”</p>
        <p class="s">ì§ˆë³‘ëª…ì´ ë°•ìŠ¤ ì•ˆì—ì„œ <b>5ì´ˆ</b> ë™ì•ˆ ë‚´ë ¤ì˜µë‹ˆë‹¤. ì•„ë˜ì—ì„œ PPE 1ê°œë¥¼ ëˆ„ë¥´ë©´ ìë™ ì±„ì  í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.</p>
      </div>

      <div class="statusBar">
        <div class="card chip">
          <div class="l">â³ ì œí•œì‹œê°„</div>
          <div class="r"><span id="timeLeft">5.0</span>s</div>
        </div>
        <div class="card chip">
          <div class="l">ìƒíƒœ</div>
          <div class="r" id="stateText">ì§„í–‰</div>
        </div>
      </div>

      <div class="card dropWrap">
        <div class="dropArea" id="dropArea">
          <div class="fallItem" id="fallItem">ì¤€ë¹„ ì¤‘â€¦</div>
          <div class="banner" id="banner"></div>
        </div>
      </div>
    </div>

    <div class="bottomFixed">
      <div class="pickHeader">
        <p class="h">ë³´í˜¸êµ¬ ì„ íƒ (4ê°œ)</p>
        <div class="sub">í•œ ë¬¸ì œë‹¹ 1ê°œë§Œ ì„ íƒ</div>
      </div>

      <div class="grid" id="optGrid">
        <div class="opt" data-val="mask" role="button" tabindex="0">
          <div class="t">ë§ˆìŠ¤í¬</div>
          <div class="d">ê¸°ë³¸(ë¹„ë§/ë¶„ë¬´)</div>
        </div>
        <div class="opt" data-val="n95" role="button" tabindex="0">
          <div class="t">N95 ë§ˆìŠ¤í¬</div>
          <div class="d">ê³µê¸°(ê²°í•µ ë“±)</div>
        </div>
        <div class="opt" data-val="gown" role="button" tabindex="0">
          <div class="t">ê°€ìš´+ì¥ê°‘</div>
          <div class="d">ì ‘ì´‰(ì˜¤ì—¼ë¬¼ ì²˜ë¦¬)</div>
        </div>
        <div class="opt" data-val="none" role="button" tabindex="0">
          <div class="t">PPE ë¶ˆí•„ìš”</div>
          <div class="d">ìœ„í—˜ ë‚®ìŒ(êµìœ¡ìš©)</div>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  // ===== ì„¤ì • =====
  const DURATION_MS = 5000;     // ë‚´ë ¤ì˜¤ëŠ” ì‹œê°„: 5ì´ˆ ê³ ì •
  const NEXT_DELAY_MS = 650;    // ì •ë‹µ/ì˜¤ë‹µ í‘œì‹œ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ
  const TOTAL_QUESTIONS = 10;

  // ===== ë¬¸ì œ(ì›í•˜ëŠ” ë§Œí¼ ì¶”ê°€/ìˆ˜ì • ê°€ëŠ¥) =====
  // val: mask | n95 | gown | none
  const QUESTIONS = [
    { text: "ì¸í”Œë£¨ì—”ì í™˜ì êµ¬ì—­ ì²­ì†Œ", ans: "mask" },
    { text: "ê²°í•µ ë³‘ì‹¤ ì²­ì†Œ", ans: "n95" },
    { text: "VRE/CRE ì¥ê¸° ì¬ì‹¤ ë³‘ì‹¤ í‡´ì‹¤ í›„ ì²­ì†Œ", ans: "gown" },
    { text: "ì¼ë°˜ ë³µë„ ë°”ë‹¥ ë§ˆë¥¸ ë¨¼ì§€ ì²­ì†Œ(ì˜¤ì—¼ ì—†ìŒ)", ans: "none" },
    { text: "êµ¬í† /ì„¤ì‚¬ ì˜¤ì—¼ë¬¼ ì²˜ë¦¬", ans: "gown" },
    { text: "CDI(ì˜ì‹¬) í™˜ì ë³‘ì‹¤ ì²­ì†Œ", ans: "gown" },
    { text: "í™ì—­ ì˜ì‹¬ í™˜ì ì´ë™ ë™ì„  ì²­ì†Œ", ans: "n95" },
    { text: "ìˆ˜ìˆ ì‹¤ ì¶œì…êµ¬ ì£¼ë³€ ì¼ë°˜ í™˜ê²½ ì²­ì†Œ", ans: "none" },
    { text: "í˜ˆì•¡ ì†ŒëŸ‰ ì˜¤ì—¼ í‘œë©´ ë‹¦ê¸°", ans: "gown" },
    { text: "RSV/ë¹„ë§ì£¼ì˜ í™˜ì ë³‘ì‹¤ ì²­ì†Œ", ans: "mask" },
  ].slice(0, TOTAL_QUESTIONS);

  // ===== DOM =====
  const qNowEl = document.getElementById("qNow");
  const qTotalEl = document.getElementById("qTotal");
  const scoreEl = document.getElementById("score");
  const timeLeftEl = document.getElementById("timeLeft");
  const stateTextEl = document.getElementById("stateText");
  const fallItem = document.getElementById("fallItem");
  const banner = document.getElementById("banner");
  const optGrid = document.getElementById("optGrid");
  const restartBtn = document.getElementById("restartBtn");

  qTotalEl.textContent = String(QUESTIONS.length);

  // ===== ìƒíƒœ =====
  let idx = 0;
  let score = 0;
  let accepting = false;
  let timerId = null;
  let startAt = 0;
  let ended = false;

  function setOptionsDisabled(disabled){
    [...optGrid.querySelectorAll(".opt")].forEach(el=>{
      if(disabled) el.classList.add("disabled");
      else el.classList.remove("disabled");
    });
  }

  function showBanner(type, msg){
    banner.className = "banner show " + (type === "good" ? "good" : "bad");
    banner.textContent = msg;
  }

  function hideBanner(){
    banner.className = "banner";
    banner.textContent = "";
  }

  function stopTimer(){
    if(timerId) clearInterval(timerId);
    timerId = null;
  }

  function stopFall(){
    fallItem.classList.remove("falling");
    // ì• ë‹ˆë©”ì´ì…˜ ì¦‰ì‹œ ë©ˆì¶”ê¸° ìœ„í•´ í˜„ì¬ ìœ„ì¹˜ ê³ ì •
    const rect = fallItem.getBoundingClientRect();
    const parentRect = fallItem.parentElement.getBoundingClientRect();
    const top = rect.top - parentRect.top;
    fallItem.style.top = `${top}px`;
  }

  function resetFallPosition(){
    fallItem.style.top = "-72px";
  }

  function updateHUD(){
    qNowEl.textContent = String(idx + 1);
    scoreEl.textContent = String(score);
  }

  function startCountdown(){
    stopTimer();
    startAt = performance.now();
    timeLeftEl.textContent = "5.0";

    timerId = setInterval(() => {
      const elapsed = performance.now() - startAt;
      const left = Math.max(0, DURATION_MS - elapsed);
      timeLeftEl.textContent = (left/1000).toFixed(1);

      if(left <= 0){
        stopTimer();
        if(accepting) timeOut();
      }
    }, 100);
  }

  function startFall(){
    resetFallPosition();
    // reflow
    void fallItem.offsetWidth;
    fallItem.style.animationDuration = `${DURATION_MS}ms`;
    fallItem.classList.add("falling");
  }

  function timeOut(){
    accepting = false;
    setOptionsDisabled(true);
    stateTextEl.textContent = "ì˜¤ë‹µ";
    showBanner("bad", "ì‹œê°„ì´ˆê³¼ âœ•");
    setTimeout(nextQuestion, NEXT_DELAY_MS);
  }

  function nextQuestion(){
    hideBanner();
    setOptionsDisabled(false);
    stateTextEl.textContent = "ì§„í–‰";
    resetFallPosition();
    stopTimer();

    idx++;
    if(idx >= QUESTIONS.length){
      endGame();
      return;
    }
    playQuestion();
  }

  function playQuestion(){
    updateHUD();
    accepting = true;

    const q = QUESTIONS[idx];
    fallItem.textContent = q.text;

    // ìë™ ì‹œì‘
    startCountdown();
    startFall();

    // ì• ë‹ˆë©”ì´ì…˜ ëë‚¬ëŠ”ë° ì„ íƒ ëª»í•˜ë©´ ì‹œê°„ì´ˆê³¼ ì²˜ë¦¬(ë³´ì¡°)
    fallItem.onanimationend = () => {
      if(accepting){
        stopTimer();
        timeOut();
      }
    };
  }

  function choose(val){
    if(!accepting || ended) return;
    accepting = false;
    setOptionsDisabled(true);
    stopTimer();
    stopFall();

    const q = QUESTIONS[idx];
    const ok = (val === q.ans);
    if(ok){
      score++;
      stateTextEl.textContent = "ì •ë‹µ";
      showBanner("good", "ì •ë‹µ âœ“");
    }else{
      stateTextEl.textContent = "ì˜¤ë‹µ";
      // ê¸¸ê²Œ ì„¤ëª… X : ì •ë‹µë§Œ ì§§ê²Œ
      const label = ({mask:"ë§ˆìŠ¤í¬", n95:"N95", gown:"ê°€ìš´+ì¥ê°‘", none:"PPE ë¶ˆí•„ìš”"})[q.ans] || q.ans;
      showBanner("bad", `ì˜¤ë‹µ âœ• / ì •ë‹µ: ${label}`);
    }
    updateHUD();
    setTimeout(nextQuestion, NEXT_DELAY_MS);
  }

  function endGame(){
    ended = true;
    accepting = false;
    setOptionsDisabled(true);
    stopTimer();
    stateTextEl.textContent = "ì™„ë£Œ";
    fallItem.textContent = "ì™„ë£Œ!";
    resetFallPosition();
    showBanner("good", `ë! ì ìˆ˜ ${score}/${QUESTIONS.length}  (â†» ì¬ì‹œì‘ ë²„íŠ¼)`);
  }

  function restart(){
    stopTimer();
    ended = false;
    idx = 0;
    score = 0;
    hideBanner();
    setOptionsDisabled(false);
    stateTextEl.textContent = "ì§„í–‰";
    updateHUD();
    playQuestion();
  }

  // í´ë¦­/í‚¤ë³´ë“œ(ì ‘ê·¼ì„±)
  optGrid.addEventListener("click", (e) => {
    const btn = e.target.closest(".opt");
    if(!btn) return;
    choose(btn.dataset.val);
  });
  optGrid.addEventListener("keydown", (e) => {
    const btn = e.target.closest(".opt");
    if(!btn) return;
    if(e.key === "Enter" || e.key === " "){
      e.preventDefault();
      choose(btn.dataset.val);
    }
  });

  restartBtn.addEventListener("click", restart);

  // ì‹œì‘
  updateHUD();
  playQuestion();
})();
</script>
</body>
</html>
