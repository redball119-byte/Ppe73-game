<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ (ê¸°ë³¸ 4ì¢… Â· ì§ˆë³‘ëª… ë‚™í•˜)</title>
  <style>
    :root{
      --bg:#071022;
      --card: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.14);
      --text:#eaf0ff;
      --muted: rgba(234,240,255,.70);
      --good:#22c55e;
      --bad:#ef4444;
      --shadow: 0 16px 34px rgba(0,0,0,.45);
      --r: 22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;
      background: radial-gradient(1200px 800px at 30% 0%, rgba(120,170,255,.16), transparent 60%),
                  radial-gradient(900px 700px at 70% 40%, rgba(80,255,170,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, "Pretendard", "Noto Sans KR", sans-serif;
      -webkit-font-smoothing:antialiased;
      overflow:hidden; /* ìŠ¤í¬ë¡¤ë¡œ ë²„íŠ¼ì´ ê°€ë ¤ì§€ëŠ” ë¬¸ì œ ë°©ì§€ */
    }

    /* ì „ì²´ í™”ë©´: ìƒë‹¨/ì¤‘ë‹¨/í•˜ë‹¨(ë³´í˜¸êµ¬) 3ì˜ì—­ì„ ì •í™•íˆ ë‚˜ëˆ” */
    .app{
      height: 100vh;
      padding: max(12px, env(safe-area-inset-top)) 12px max(12px, env(safe-area-inset-bottom));
      display:grid;
      grid-template-rows: auto auto 1fr auto; /* í—¤ë” / ì•ˆë‚´ / ê²Œì„ / ë³´í˜¸êµ¬ */
      gap: 10px;
      max-width: 520px;
      margin: 0 auto;
    }

    .row3{
      display:grid;
      grid-template-columns: 1.2fr .9fr .9fr;
      gap:10px;
    }
    .card{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 12px 12px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .title{
      display:flex; gap:10px; align-items:flex-start;
    }
    .title .emoji{font-size:22px; line-height:1;}
    .title h1{
      margin:0;
      font-size: clamp(16px, 2.8vw, 20px);
      letter-spacing:-.2px;
    }
    .title .sub{
      margin-top:4px;
      font-size: 12px;
      color: var(--muted);
    }

    .stat{
      display:flex;
      flex-direction:column;
      gap:6px;
      justify-content:center;
      align-items:center;
      text-align:center;
      min-height: 64px;
    }
    .stat .label{font-size:12px;color:var(--muted)}
    .stat .value{font-weight:800;font-size: clamp(18px, 4.2vw, 26px)}

    .guide h2{
      margin:0 0 6px 0;
      font-size: clamp(16px, 3.3vw, 20px);
      letter-spacing:-.2px;
    }
    .guide ol{
      margin:0;
      padding-left: 18px;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.45;
    }

    /* ê²Œì„ ì˜ì—­ */
    .game{
      display:grid;
      grid-template-rows: auto 1fr; /* ìƒë‹¨ ìƒíƒœì¤„ / ë‚™í•˜ì§€ì—­ */
      gap:10px;
      min-height: 0; /* grid ì•ˆì—ì„œ overflow ì´ìŠˆ ë°©ì§€ */
    }

    .statusRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .pill{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      padding:10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color: var(--muted);
      font-size: 13px;
      white-space:nowrap;
    }
    .pill b{color:var(--text); font-size: 14px}

    .dropZone{
      position:relative;
      border-radius: var(--r);
      border: 2px dashed rgba(255,255,255,.18);
      background: rgba(0,0,0,.10);
      overflow:hidden; /* ë‚™í•˜ í…ìŠ¤íŠ¸ê°€ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šê²Œ */
      min-height: 0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 12px;
    }

    /* ì—¬ê¸°ì—ì„œ í…ìŠ¤íŠ¸ê°€ â€œì˜ë¦¬ë˜â€ ë¬¸ì œ í•´ê²°:
       - dropItemì´ zone ì•ˆì—ì„œ ì¶©ë¶„íˆ ì»¤ì§€ê³ 
       - ì¤„ë°”ê¿ˆë˜ê³ 
       - ìµœëŒ€ í­ ì œí•œ
    */
    .dropItem{
      position:absolute;
      left: 50%;
      transform: translateX(-50%);
      top: -40%; /* ìœ„ì—ì„œ ì‹œì‘ */
      width: min(92%, 420px);
      padding: 14px 14px;
      text-align:center;
      font-weight: 900;
      font-size: clamp(18px, 5.2vw, 30px);
      line-height: 1.15;
      letter-spacing: -0.4px;
      border-radius: 18px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.18);
      text-shadow: 0 2px 8px rgba(0,0,0,.35);
      word-break: keep-all;
      overflow-wrap: anywhere;
      display:none;
      z-index: 2;
    }

    .hintText{
      color: rgba(234,240,255,.45);
      font-size: 13px;
      text-align:center;
      padding: 0 10px;
      z-index:1;
    }

    /* ê²°ê³¼ ì´ë¯¸ì§€ (ì •ë‹µ/ì˜¤ë‹µ) */
    .resultWrap{
      position:absolute;
      inset: 0;
      display:none;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:10px;
      background: rgba(0,0,0,.28);
      z-index: 5;
      padding: 14px;
      text-align:center;
    }
    .resultWrap img{
      width: min(54vw, 220px);
      max-height: 22vh;
      object-fit: contain;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,.35));
    }
    .resultWrap .big{
      font-size: 22px;
      font-weight: 900;
      letter-spacing:-.2px;
    }
    .resultWrap .small{
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.35;
      max-width: 460px;
    }

    /* ë³´í˜¸êµ¬ ì˜ì—­: í•­ìƒ í™”ë©´ì— ë³´ì´ê²Œ ê³ ì •ëœ â€œë§ˆì§€ë§‰ í–‰â€ */
    .ppeBox{
      display:grid;
      grid-template-rows: auto auto;
      gap: 10px;
    }
    .ppeHead{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      color: var(--muted);
      font-size: 12px;
      padding: 0 4px;
    }
    .ppeHead b{
      color: var(--text);
      font-size: 18px;
      letter-spacing:-.2px;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .btn{
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      border-radius: 22px;
      padding: 14px 12px;
      background: rgba(255,255,255,.07);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 10px 18px rgba(0,0,0,.20);
      color: var(--text);
      font-weight: 900;
      text-align:center;
      cursor:pointer;
      min-height: 64px; /* ì†ê°€ë½ í„°ì¹˜ìš© */
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap: 4px;
    }
    .btn .sub{
      font-weight:700;
      font-size: 12px;
      color: rgba(234,240,255,.65);
    }
    .btn:active{transform: scale(.99)}
    .btn.disabled{opacity:.45; pointer-events:none}

    .foot{
      text-align:center;
      font-size: 11.5px;
      color: rgba(234,240,255,.55);
      margin-top: 2px;
    }

    /* ì‘ì€ í°ì—ì„œ ì•ˆë‚´ë¬¸ì´ ë„ˆë¬´ ê¸¸ì–´ ë³´í˜¸êµ¬ê°€ ê°€ë ¤ì§€ëŠ” ê²ƒì„ ë°©ì§€ */
    @media (max-height: 740px){
      .guide ol{display:none;} /* ë†’ì´ê°€ ë‚®ìœ¼ë©´ ì•ˆë‚´ë¬¸ ì ‘ê¸° */
      .guide h2{margin-bottom:0;}
    }
  </style>
</head>

<body>
  <div class="app">

    <!-- ìƒë‹¨ -->
    <div class="row3">
      <div class="card">
        <div class="title">
          <div class="emoji">ğŸ§¹</div>
          <div>
            <h1>í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ</h1>
            <div class="sub">ê¸°ë³¸ 4ì¢… Â· ì§ˆë³‘ëª… ë‚™í•˜</div>
          </div>
        </div>
      </div>
      <div class="card stat">
        <div class="label">ë¬¸í•­</div>
        <div class="value" id="qStat">1/10</div>
      </div>
      <div class="card stat">
        <div class="label">ì ìˆ˜</div>
        <div class="value" id="scoreStat">0</div>
      </div>
    </div>

    <!-- ì•ˆë‚´ -->
    <div class="card guide">
      <h2>ì§ˆë³‘/ìƒí™©ì„ ë³´ê³  í•„ìš”í•œ PPE 1ê°œë¥¼ ê³ ë¥´ì„¸ìš”</h2>
      <ol>
        <li>ì§ˆë³‘ëª…ì´ ë„¤ëª¨ì¹¸ ìœ„ì—ì„œ ì•„ë˜ë¡œ <b>í•­ìƒ 5ì´ˆ</b> ë™ì•ˆ ë‚´ë ¤ì˜µë‹ˆë‹¤. (ì‹œê°„ ì´ˆê³¼ ì‹œ ì˜¤ë‹µ)</li>
        <li>ì•„ë˜ì—ì„œ PPE 1ê°œë¥¼ ëˆ„ë¥´ë©´ ì±„ì  í›„ <b>ìë™ìœ¼ë¡œ ë‹¤ìŒ ë¬¸ì œ</b>ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤. (ì‹œì‘ ë²„íŠ¼ ì—†ìŒ)</li>
      </ol>
    </div>

    <!-- ê²Œì„ -->
    <div class="card game">
      <div class="statusRow">
        <div class="pill">â³ ì œí•œì‹œê°„: <b id="timeLeft">5.0s</b></div>
        <div class="pill">ìƒíƒœ: <b id="state">ëŒ€ê¸°</b></div>
      </div>

      <div class="dropZone" id="zone">
        <div class="hintText" id="hint">ê³§ ë¬¸ì œê°€ ë–¨ì–´ì§‘ë‹ˆë‹¤â€¦</div>

        <div class="dropItem" id="dropItem">ë¬¸ì œ</div>

        <div class="resultWrap" id="resultWrap">
          <img id="resultImg" alt="result" src="assets/idle.png">
          <div class="big" id="resultTitle">ì •ë‹µ</div>
          <div class="small" id="resultText">ì„¤ëª…</div>
        </div>
      </div>
    </div>

    <!-- ë³´í˜¸êµ¬ -->
    <div class="ppeBox">
      <div class="ppeHead">
        <div><b>ë³´í˜¸êµ¬ ì„ íƒ (4ê°œ)</b></div>
        <div>í•œ ë¬¸ì œë‹¹ 1ê°œë§Œ ì„ íƒ</div>
      </div>

      <div class="grid" id="btnGrid">
        <div class="btn" data-key="mask">
          ë§ˆìŠ¤í¬
          <div class="sub">ê¸°ë³¸(ë¹„ë§/ë¶„ë¬´)</div>
        </div>
        <div class="btn" data-key="n95">
          N95 ë§ˆìŠ¤í¬
          <div class="sub">ê³µê¸°(ê²°í•µ ë“±)</div>
        </div>
        <div class="btn" data-key="gown_glove">
          ê°€ìš´+ì¥ê°‘
          <div class="sub">ì ‘ì´‰(ì˜¤ì—¼ë¬¼ ì²˜ë¦¬)</div>
        </div>
        <div class="btn" data-key="none">
          PPE ë¶ˆí•„ìš”
          <div class="sub">ìœ„í—˜ ë‚®ìŒ(êµìœ¡ìš©)</div>
        </div>
      </div>

      <div class="foot">â€» êµìœ¡ìš© ë‹¨ìˆœí™” ë²„ì „(í‘œì¤€ì£¼ì˜+ì¶”ê°€ì£¼ì˜ ê°œë… ê¸°ë°˜)</div>
    </div>
  </div>

  <script>
    // ===== ë¬¸ì œ ë°ì´í„°(ì˜ˆì‹œ) =====
    // key: mask / n95 / gown_glove / none
    const QUESTIONS = [
      { text:"ì¸í”Œë£¨ì—”ì í™˜ì êµ¬ì—­ ì²­ì†Œ", answer:"mask", explain:"ë¹„ë§/ë¶„ë¬´ ìœ„í—˜ â†’ ë§ˆìŠ¤í¬" },
      { text:"ê²°í•µ ë³‘ì‹¤ ì²­ì†Œ", answer:"n95", explain:"ê³µê¸°ì£¼ì˜ â†’ N95" },
      { text:"ìƒì²˜ ë°°ë†/ì‚¼ì¶œë¬¼ ì£¼ë³€ ì²­ì†Œ", answer:"gown_glove", explain:"ì²´ì•¡ ì ‘ì´‰ ìœ„í—˜ â†’ ê°€ìš´+ì¥ê°‘" },
      { text:"ì¼ë°˜ ë³µë„ ì†ì¡ì´(ì˜¤ì—¼ ì—†ìŒ) ì ê²€", answer:"none", explain:"êµìœ¡ìš© ë‹¨ìˆœí™”: ìœ„í—˜ ë‚®ìŒ â†’ PPE ë¶ˆí•„ìš”" },
      { text:"VRE/CRE ì¥ê¸° ì¬ì‹¤ ë³‘ì‹¤ í‡´ì‹¤ í›„ ì²­ì†Œ", answer:"gown_glove", explain:"ì ‘ì´‰ì£¼ì˜ í™˜ê²½ì˜¤ì—¼ ê°€ëŠ¥ â†’ ê°€ìš´+ì¥ê°‘" },
      { text:"êµ¬í† /ì„¤ì‚¬(ë…¸ë¡œ ì˜ì‹¬) êµ¬ì—­ ì²­ì†Œ", answer:"mask", explain:"ë¹„ë§/ë¶„ë¬´ ê°€ëŠ¥ â†’ ë§ˆìŠ¤í¬(êµìœ¡ìš© ë‹¨ìˆœí™”)" },
      { text:"ê²©ë¦¬ì‹¤ ë¬¸ê³ ë¦¬Â·ì¹¨ìƒ ë‚œê°„ ì§‘ì¤‘ ì²­ì†Œ", answer:"gown_glove", explain:"ì ‘ì´‰ì˜¤ì—¼ ê°€ëŠ¥ â†’ ê°€ìš´+ì¥ê°‘" },
      { text:"íë ´ í™˜ì ì¼ë°˜ ë³‘ì‹¤ ë°”ë‹¥ ì²­ì†Œ", answer:"mask", explain:"ë¹„ë§/ë¶„ë¬´ ê°€ëŠ¥ â†’ ë§ˆìŠ¤í¬(êµìœ¡ìš©)" },
      { text:"í˜ˆì•¡ì´ ë¬»ì€ êµ¬ì—­ ì†Œë…(ìŠ¤í•„)", answer:"gown_glove", explain:"ì˜¤ì—¼ë¬¼ ì²˜ë¦¬ â†’ ê°€ìš´+ì¥ê°‘" },
      { text:"ê²€ì²´ ì±„ì·¨ì‹¤ ì£¼ë³€ ì¼ë°˜ ì²­ì†Œ", answer:"mask", explain:"ë¶„ë¬´ ê°€ëŠ¥ â†’ ë§ˆìŠ¤í¬(êµìœ¡ìš©)" },
    ];

    // ===== ì„¤ì • =====
    const DROP_SECONDS = 5.0;          // â€œí•­ìƒ 5ì´ˆâ€
    const NEXT_DELAY_MS = 650;         // ê²°ê³¼ ë³´ì—¬ì£¼ëŠ” ì‹œê°„
    const RESULT_SHOW_MS = 900;        // ê²°ê³¼ ì˜¤ë²„ë ˆì´ ìœ ì§€

    // ===== DOM =====
    const qStat = document.getElementById("qStat");
    const scoreStat = document.getElementById("scoreStat");
    const timeLeft = document.getElementById("timeLeft");
    const stateEl = document.getElementById("state");
    const hint = document.getElementById("hint");
    const zone = document.getElementById("zone");
    const dropItem = document.getElementById("dropItem");
    const resultWrap = document.getElementById("resultWrap");
    const resultImg = document.getElementById("resultImg");
    const resultTitle = document.getElementById("resultTitle");
    const resultText = document.getElementById("resultText");
    const buttons = Array.from(document.querySelectorAll(".btn"));

    // ===== ìƒíƒœ =====
    let idx = 0;
    let score = 0;
    let running = false;
    let answered = false;
    let raf = null;
    let startAt = 0;

    function setButtonsDisabled(disabled){
      buttons.forEach(b => b.classList.toggle("disabled", disabled));
    }

    function updateTop(){
      qStat.textContent = `${Math.min(idx+1, QUESTIONS.length)}/${QUESTIONS.length}`;
      scoreStat.textContent = `${score}`;
    }

    function showResult(ok, q, picked){
      resultWrap.style.display = "flex";
      resultImg.src = ok ? "assets/correct.png" : "assets/wrong.png";
      resultTitle.textContent = ok ? "ì •ë‹µ âœ…" : "ì˜¤ë‹µ âŒ";
      resultTitle.style.color = ok ? "var(--good)" : "var(--bad)";
      resultText.textContent = `ë¬¸ì œ: ${q.text} / ì„ íƒ: ${picked ?? "ì—†ìŒ(ì‹œê°„ì´ˆê³¼)"} / ì •ë‹µ: ${labelOf(q.answer)}\nì„¤ëª…: ${q.explain}`;
    }

    function hideResult(){
      resultWrap.style.display = "none";
      resultImg.src = "assets/idle.png";
    }

    function labelOf(key){
      return ({
        mask:"ë§ˆìŠ¤í¬",
        n95:"N95 ë§ˆìŠ¤í¬",
        gown_glove:"ê°€ìš´+ì¥ê°‘",
        none:"PPE ë¶ˆí•„ìš”"
      })[key] || key;
    }

    function stopAnim(){
      if(raf) cancelAnimationFrame(raf);
      raf = null;
    }

    function startQuestion(){
      if(idx >= QUESTIONS.length){
        stateEl.textContent = "ì™„ë£Œ";
        hint.textContent = `ë! ì ìˆ˜: ${score}/${QUESTIONS.length}`;
        dropItem.style.display = "none";
        setButtonsDisabled(true);
        return;
      }

      running = true;
      answered = false;
      setButtonsDisabled(false);
      hideResult();

      const q = QUESTIONS[idx];
      updateTop();

      stateEl.textContent = "ì§„í–‰";
      hint.style.display = "none";
      dropItem.textContent = q.text;
      dropItem.style.display = "block";

      // ë‚™í•˜ ì‹œì‘/ì¢…ë£Œ ìœ„ì¹˜(ì¡´ ë‚´ë¶€ì—ì„œ í™•ì‹¤íˆ ë³´ì´ê²Œ)
      const zoneH = zone.clientHeight;
      const startY = -0.30 * zoneH;   // ìœ„ìª½
      const endY   =  0.58 * zoneH;   // ì•„ë˜ìª½(ë³´í˜¸êµ¬ ì˜ì—­ê³¼ ê²¹ì¹˜ì§€ ì•Šê²Œ)

      startAt = performance.now();

      function frame(now){
        const t = (now - startAt) / (DROP_SECONDS * 1000);
        const clamped = Math.min(Math.max(t, 0), 1);
        const y = startY + (endY - startY) * clamped;

        dropItem.style.top = `${y}px`;

        const remain = Math.max(0, DROP_SECONDS - (now - startAt)/1000);
        timeLeft.textContent = `${remain.toFixed(1)}s`;

        if(clamped >= 1 && !answered){
          // ì‹œê°„ì´ˆê³¼ ì²˜ë¦¬
          answered = true;
          setButtonsDisabled(true);
          stateEl.textContent = "ì˜¤ë‹µ";
          showResult(false, q, null);

          setTimeout(() => {
            hideResult();
            idx++;
            startQuestion(); // ìë™ ë‹¤ìŒë¬¸ì œ
          }, RESULT_SHOW_MS);
          return;
        }

        if(!answered) raf = requestAnimationFrame(frame);
      }

      stopAnim();
      raf = requestAnimationFrame(frame);
    }

    function answer(pickedKey){
      if(!running || answered) return;

      const q = QUESTIONS[idx];
      answered = true;
      setButtonsDisabled(true);
      stopAnim();

      const ok = (pickedKey === q.answer);
      if(ok) score++;

      stateEl.textContent = ok ? "ì •ë‹µ" : "ì˜¤ë‹µ";
      updateTop();

      showResult(ok, q, labelOf(pickedKey));

      setTimeout(() => {
        hideResult();
        idx++;
        startQuestion(); // ìë™ ë‹¤ìŒë¬¸ì œ
      }, RESULT_SHOW_MS);
    }

    // ë²„íŠ¼ í´ë¦­
    buttons.forEach(btn=>{
      btn.addEventListener("click", ()=> answer(btn.dataset.key));
      btn.addEventListener("touchend", (e)=>{ e.preventDefault(); answer(btn.dataset.key); }, {passive:false});
    });

    // í™”ë©´ íšŒì „/ë¦¬ì‚¬ì´ì¦ˆ ì‹œë„ â€œë¬¸ì œê°€ ì˜ë ¤ ë³´ì´ëŠ” í˜„ìƒâ€ ë°©ì§€ìš© ì¬ì‹œì‘
    let resizeTimer = null;
    window.addEventListener("resize", ()=>{
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(()=>{
        if(!answered) startQuestion();
      }, 120);
    });

    // ìë™ ì‹œì‘
    updateTop();
    stateEl.textContent = "ëŒ€ê¸°";
    setButtonsDisabled(true);

    // ì²« ë¬¸ì œ ìë™ ì‹œì‘ (í˜ì´ì§€ ëœ¨ê³  0.3ì´ˆ í›„)
    setTimeout(()=>{
      setButtonsDisabled(false);
      startQuestion();
    }, 300);
  </script>
</body>
</html>
