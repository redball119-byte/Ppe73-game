<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ</title>
  <style>
    :root{
      --bg:#071022;
      --card: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.12);
      --text:#eaf0ff;
      --muted: rgba(234,240,255,.65);
      --good:#22c55e;
      --bad:#ef4444;
      --btn: rgba(255,255,255,.10);
      --btn2: rgba(255,255,255,.16);
      --shadow: 0 18px 40px rgba(0,0,0,.45);
      --r: 22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(1200px 700px at 50% -10%, rgba(255,255,255,.10), transparent 60%),
                  linear-gradient(180deg, #071022 0%, #06101f 100%);
      color:var(--text);
      font-family: system-ui, -apple-system, "Pretendard", "Apple SD Gothic Neo", "Noto Sans KR", Arial, sans-serif;
      overflow:hidden; /* í•œ í™”ë©´ ê³ ì • */
    }
    .app{
      height:100vh;
      height:100svh;
      padding: 12px 12px calc(12px + env(safe-area-inset-bottom));
      display:flex;
      flex-direction:column;
      gap:10px;
      max-width: 520px;
      margin:0 auto;
    }

    /* ìƒë‹¨ 3ì¹¸: ê¸€ì”¨ ë„ˆë¬´ ì»¤ì„œ ì¤„ì„ */
    .top{
      display:grid;
      grid-template-columns: 1.4fr .8fr .8fr;
      gap:10px;
    }
    .pill{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius: 18px;
      padding:10px 12px;
      box-shadow: var(--shadow);
      min-height: 70px;
      display:flex;
      flex-direction:column;
      justify-content:center;
    }
    .pill .t1{font-size:15px; font-weight:800; line-height:1.15}
    .pill .t2{font-size:12px; color:var(--muted); margin-top:4px}
    .pill .big{font-size:22px; font-weight:900; margin-top:4px}

    /* ì•ˆë‚´ ì¹´ë“œ */
    .card{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius: var(--r);
      padding:12px 14px;
      box-shadow: var(--shadow);
    }
    .card h2{
      margin:0 0 6px 0;
      font-size:18px;
      line-height:1.2;
      font-weight:900;
      letter-spacing:-.2px;
    }
    .card p{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.5;
    }

    /* ìƒíƒœì¤„ */
    .statusRow{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:center;
    }
    .chip{
      background: rgba(255,255,255,.06);
      border:1px solid var(--stroke);
      border-radius: 999px;
      padding:8px 12px;
      display:flex;
      align-items:center;
      gap:8px;
      min-width: 140px;
      justify-content:center;
    }
    .chip b{font-size:16px}
    .chip span{font-size:13px; color:var(--muted)}

    /* ë–¨ì–´ì§€ëŠ” ë„¤ëª¨ì¹¸(ë¬¸ì œ ì˜ì—­) - ì¶©ë¶„íˆ í¬ê²Œ */
    .playCard{
      background: rgba(255,255,255,.06);
      border:1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding:12px;
      flex: 1 1 auto;          /* ë‚¨ëŠ” ê³µê°„ì„ ë¬¸ì œì˜ì—­ì´ ë¨¹ê²Œ */
      min-height: 240px;       /* ë„ˆë¬´ ì‘ì•„ì§€ì§€ ì•Šê²Œ */
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .dropZone{
      position:relative;
      flex:1 1 auto;
      border-radius: 18px;
      border:2px dashed rgba(234,240,255,.20);
      background: linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.30));
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height: 200px;
    }
    .hintText{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      color: rgba(234,240,255,.35);
      font-weight:800;
      text-align:center;
      padding:10px;
      pointer-events:none;
    }
    .fallItem{
      position:absolute;
      left:50%;
      transform: translateX(-50%);
      top: -80px;
      width: min(92%, 420px);
      padding:14px 16px;
      border-radius: 18px;
      background: rgba(255,255,255,.09);
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      text-align:center;
      font-weight: 950;
      font-size: clamp(22px, 5.6vw, 34px);
      letter-spacing: -0.6px;
      line-height:1.1;
      user-select:none;
    }

    /* í•˜ë‹¨ ì„ íƒ ì˜ì—­: í•­ìƒ ë³´ì´ë„ë¡ ê³ ì • */
    .footer{
      background: rgba(0,0,0,.0);
      padding-top: 6px;
      flex: 0 0 auto;
    }
    .footerTitle{
      display:flex;
      justify-content:space-between;
      align-items:end;
      margin: 0 2px 8px 2px;
    }
    .footerTitle b{font-size:18px}
    .footerTitle span{font-size:12px; color:var(--muted)}

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .btn{
      border:1px solid var(--stroke);
      background: var(--btn);
      color: var(--text);
      border-radius: 18px;
      padding:14px 12px;
      font-weight:900;
      font-size:18px;
      box-shadow: var(--shadow);
      cursor:pointer;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{transform: translateY(1px)}
    .btn small{
      display:block;
      margin-top:6px;
      font-weight:700;
      font-size:12px;
      color: var(--muted);
      letter-spacing:-.2px;
    }

    /* ê²°ê³¼ ì˜¤ë²„ë ˆì´: ë²„íŠ¼ í´ë¦­ì„ ë§‰ì§€ ì•Šê²Œ pointer-events ì¡°ì ˆ */
    .overlay{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:16px;
      background: rgba(0,0,0,.45);
      z-index: 50;
    }
    .overlay.show{display:flex;}
    .modal{
      width:min(520px, 96vw);
      background: rgba(12,18,34,.92);
      border:1px solid rgba(255,255,255,.15);
      border-radius: 22px;
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
      padding:14px;
    }
    .modalTop{
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom:10px;
    }
    .badge{
      font-weight:950;
      font-size:22px;
      letter-spacing:-.3px;
    }
    .badge.good{color:var(--good)}
    .badge.bad{color:var(--bad)}
    .modal p{
      margin:8px 0 0 0;
      color: rgba(234,240,255,.78);
      font-size:13px;
      line-height:1.45;
    }
    .resultImg{
      width:100%;
      max-height: 180px;
      object-fit: contain;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      display:none;
    }

    .note{
      margin-top:6px;
      font-size:12px;
      color: rgba(234,240,255,.45);
      text-align:center;
      line-height:1.35;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="top">
      <div class="pill">
        <div class="t1">ğŸ§¹ í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ</div>
        <div class="t2">ê¸°ë³¸ 4ì¢… Â· ì§ˆë³‘ëª… ë‚™í•˜</div>
      </div>
      <div class="pill" id="qPill">
        <div class="t2">ë¬¸í•­</div>
        <div class="big"><span id="qNow">0</span>/<span id="qTotal">10</span></div>
      </div>
      <div class="pill">
        <div class="t2">ì ìˆ˜</div>
        <div class="big" id="score">0</div>
      </div>
    </div>

    <div class="card">
      <h2>ì§ˆë³‘/ìƒí™©ì„ ë³´ê³  í•„ìš”í•œ PPE 1ê°œë¥¼ ê³ ë¥´ì„¸ìš”</h2>
      <p>
        â‘  ì§ˆë³‘ëª…ì´ ë„¤ëª¨ì¹¸ ìœ„ì—ì„œ ì•„ë˜ë¡œ <b>5ì´ˆ</b> ë™ì•ˆ ë‚´ë ¤ì˜µë‹ˆë‹¤. (ì‹œê°„ ì´ˆê³¼ ì‹œ ì˜¤ë‹µ)<br>
        â‘¡ ì•„ë˜ ë²„íŠ¼ì—ì„œ PPE 1ê°œë¥¼ ì„ íƒí•˜ë©´ ìë™ ì±„ì  í›„ <b>ìë™ìœ¼ë¡œ ë‹¤ìŒ ë¬¸ì œ</b>ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.
      </p>
    </div>

    <div class="playCard">
      <div class="statusRow">
        <div class="chip"><span>â³ ì œí•œì‹œê°„:</span> <b id="timeLeft">5.0s</b></div>
        <div class="chip"><span>ìƒíƒœ:</span> <b id="state">ëŒ€ê¸°</b></div>
      </div>

      <div class="dropZone" id="dropZone">
        <div class="hintText" id="hintText">ì ì‹œ í›„ ë¬¸ì œê°€ ì‹œì‘ë©ë‹ˆë‹¤</div>
        <div class="fallItem" id="fallItem" style="display:none;">ë¬¸ì œ</div>
      </div>
    </div>

    <div class="footer">
      <div class="footerTitle">
        <b>ë³´í˜¸êµ¬ ì„ íƒ (4ê°œ)</b>
        <span>í•œ ë¬¸ì œë‹¹ 1ê°œ ì„ íƒ</span>
      </div>

      <div class="grid">
        <button class="btn" data-ppe="mask">ë§ˆìŠ¤í¬<small>ê¸°ë³¸(ë¹„ë§/ë¶„ë¬´)</small></button>
        <button class="btn" data-ppe="n95">N95 ë§ˆìŠ¤í¬<small>ê³µê¸°(ê²°í•µ ë“±)</small></button>
        <button class="btn" data-ppe="gown_gloves">ê°€ìš´+ì¥ê°‘<small>ì ‘ì´‰(ì˜¤ì—¼ë¬¼ ì²˜ë¦¬)</small></button>
        <button class="btn" data-ppe="none">PPE ë¶ˆí•„ìš”<small>ìœ„í—˜ ë‚®ìŒ(êµìœ¡ìš©)</small></button>
      </div>

      <div class="note">â€» êµìœ¡ìš© ë‹¨ìˆœí™” ë²„ì „(í‘œì¤€ì£¼ì˜+ì¶”ê°€ì£¼ì˜ ê°œë… ê¸°ë°˜)</div>
    </div>
  </div>

  <!-- ê²°ê³¼ ëª¨ë‹¬ -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="modal">
      <div class="modalTop">
        <div class="badge" id="badge">ì •ë‹µ</div>
      </div>
      <img id="resultImg" class="resultImg" alt="result" />
      <p id="resultText"></p>
    </div>
  </div>

<script>
(() => {
  // ===== ì„¤ì • =====
  const TOTAL = 10;
  const FALL_SECONDS = 5.0;          // ë¬´ì¡°ê±´ 5ì´ˆ
  const AFTER_FEEDBACK_MS = 700;     // ê²°ê³¼ ë³´ì—¬ì£¼ê³  ë‹¤ìŒë¬¸ì œê¹Œì§€ ë”œë ˆì´

  // assets í´ë”ì— ìˆìœ¼ë©´ ìë™ í‘œì‹œ(ì—†ì–´ë„ ë™ì‘)
  const IMG_IDLE = "assets/idle.png";
  const IMG_OK   = "assets/correct.png";
  const IMG_BAD  = "assets/wrong.png";

  // ===== ë¬¸ì œ(ì˜ˆì‹œ 10ê°œ) - ì›í•˜ë©´ ì—¬ê¸°ë§Œ ëŠ˜ë¦¬ë©´ ë¨ =====
  // ppe: mask | n95 | gown_gloves | none
  const questions = [
    { text:"ì¸í”Œë£¨ì—”ì í™˜ì êµ¬ì—­ ì²­ì†Œ", ppe:"mask", desc:"ë¹„ë§/ë¶„ë¬´ ìœ„í—˜ â†’ ë§ˆìŠ¤í¬" },
    { text:"ê²°í•µ ë³‘ì‹¤ ì²­ì†Œ", ppe:"n95", desc:"ê³µê¸°ì „íŒŒ ìœ„í—˜ â†’ N95" },
    { text:"ìƒì²˜ ë°°ë†/ì‚¼ì¶œë¬¼ ì£¼ë³€ ì²­ì†Œ", ppe:"gown_gloves", desc:"ì²´ì•¡ ì ‘ì´‰ ìœ„í—˜ â†’ ê°€ìš´+ì¥ê°‘" },
    { text:"í˜ˆì•¡/ì²´ì•¡ ì˜¤ì—¼ë¬¼(ì†ŒëŸ‰) ì²˜ë¦¬", ppe:"gown_gloves", desc:"ì˜¤ì—¼ë¬¼ ì ‘ì´‰ ìœ„í—˜ â†’ ê°€ìš´+ì¥ê°‘" },
    { text:"ì½”í˜¸íŠ¸ êµ¬ì—­ ë°”ë‹¥ ì²­ì†Œ(ë¹„ë§ì£¼ì˜)", ppe:"mask", desc:"ë¹„ë§ì£¼ì˜ ìƒí™© â†’ ë§ˆìŠ¤í¬" },
    { text:"ê²°í•µ ì˜ì‹¬ í™˜ì ì´ë™ í›„ êµ¬ì—­ ì²­ì†Œ", ppe:"n95", desc:"ê³µê¸°ì£¼ì˜ ìƒí™© â†’ N95" },
    { text:"í™˜ì ì—†ëŠ” ì¼ë°˜ ë³µë„ ë¨¼ì§€ ì œê±°(êµìœ¡ìš©)", ppe:"none", desc:"ìœ„í—˜ ë‚®ìŒ â†’ PPE ë¶ˆí•„ìš”(êµìœ¡ìš©)" },
    { text:"MRSA ê²©ë¦¬ë³‘ì‹¤ í™˜ê²½ì •ë¦¬(í‘œë©´ ì ‘ì´‰)", ppe:"gown_gloves", desc:"ì ‘ì´‰ì£¼ì˜ ìƒí™© â†’ ê°€ìš´+ì¥ê°‘" },
    { text:"êµ¬í† /ì„¤ì‚¬ í™˜ì í™”ì¥ì‹¤ ì£¼ë³€ ì²­ì†Œ", ppe:"gown_gloves", desc:"ì˜¤ì—¼ë¬¼ ì ‘ì´‰ ìœ„í—˜ â†’ ê°€ìš´+ì¥ê°‘" },
    { text:"ê¸°ì¹¨ ì‹¬í•œ í˜¸í¡ê¸° í™˜ì êµ¬ì—­ ì²­ì†Œ", ppe:"mask", desc:"ë¹„ë§ ìœ„í—˜ â†’ ë§ˆìŠ¤í¬" },
  ].slice(0, TOTAL);

  // ===== DOM =====
  const qNowEl = document.getElementById("qNow");
  const qTotalEl = document.getElementById("qTotal");
  const scoreEl = document.getElementById("score");
  const timeLeftEl = document.getElementById("timeLeft");
  const stateEl = document.getElementById("state");
  const hintText = document.getElementById("hintText");
  const fallItem = document.getElementById("fallItem");
  const dropZone = document.getElementById("dropZone");

  const overlay = document.getElementById("overlay");
  const badge = document.getElementById("badge");
  const resultText = document.getElementById("resultText");
  const resultImg = document.getElementById("resultImg");

  qTotalEl.textContent = String(questions.length);

  // ===== ìƒíƒœ =====
  let idx = 0;
  let score = 0;
  let running = false;
  let answered = false;
  let rafId = null;
  let startTs = 0;

  // ì´ë¯¸ì§€ ì¡´ì¬í•˜ë©´ ë³´ì—¬ì£¼ê¸°(ì—†ìœ¼ë©´ ìˆ¨ê¹€)
  function setResultImage(src){
    resultImg.style.display = "none";
    resultImg.removeAttribute("src");
    const img = new Image();
    img.onload = () => {
      resultImg.src = src;
      resultImg.style.display = "block";
    };
    img.onerror = () => {
      resultImg.style.display = "none";
    };
    img.src = src;
  }

  function showOverlay(ok, q, chosen){
    badge.textContent = ok ? "ì •ë‹µ âœ…" : "ì˜¤ë‹µ âŒ";
    badge.className = "badge " + (ok ? "good" : "bad");

    setResultImage(ok ? IMG_OK : IMG_BAD);

    const chosenText = ppeLabel(chosen);
    const ansText = ppeLabel(q.ppe);
    resultText.textContent =
      `ë¬¸ì œ: ${q.text}  | ì„ íƒ: ${chosenText}  | ì •ë‹µ: ${ansText}\nì„¤ëª…: ${q.desc}`;

    overlay.classList.add("show");
    overlay.setAttribute("aria-hidden", "false");
  }

  function hideOverlay(){
    overlay.classList.remove("show");
    overlay.setAttribute("aria-hidden", "true");
  }

  function ppeLabel(code){
    switch(code){
      case "mask": return "ë§ˆìŠ¤í¬";
      case "n95": return "N95 ë§ˆìŠ¤í¬";
      case "gown_gloves": return "ê°€ìš´+ì¥ê°‘";
      case "none": return "PPE ë¶ˆí•„ìš”";
      default: return "ì„ íƒ ì—†ìŒ";
    }
  }

  function setState(text){ stateEl.textContent = text; }

  function setTime(sec){
    timeLeftEl.textContent = sec.toFixed(1) + "s";
  }

  // ===== ì• ë‹ˆë©”ì´ì…˜/íƒ€ì´ë¨¸ =====
  function startQuestion(){
    if (idx >= questions.length) return finishGame();

    running = true;
    answered = false;
    startTs = performance.now();

    qNowEl.textContent = String(idx + 1);
    hintText.textContent = "";
    setState("ì§„í–‰");

    // ë¬¸ì œ í‘œì‹œ
    fallItem.style.display = "block";
    fallItem.textContent = questions[idx].text;

    // ì‹œì‘ ìœ„ì¹˜ëŠ” ìƒë‹¨ ë°–
    fallItem.style.top = "-90px";

    // ë“œë¡­ì¡´ ë†’ì´ ê³„ì‚°
    const zoneRect = dropZone.getBoundingClientRect();
    const itemRect = fallItem.getBoundingClientRect();
    const startY = -90; // px
    const endY = Math.max( (zoneRect.height - itemRect.height) , 10 ); // ë°”ë‹¥ ì§ì „ê¹Œì§€
    const duration = FALL_SECONDS * 1000;

    cancelAnimationFrame(rafId);

    const tick = (now) => {
      if (!running) return;

      const t = Math.min((now - startTs) / duration, 1);
      const y = startY + (endY - startY) * t;
      fallItem.style.top = y + "px";

      const left = Math.max(0, FALL_SECONDS - (now - startTs) / 1000);
      setTime(left);

      if (t >= 1 && !answered){
        // ì‹œê°„ ì´ˆê³¼
        answered = true;
        running = false;
        setState("ì‹œê°„ì´ˆê³¼");
        gradeAnswer(null, true);
        return;
      }
      rafId = requestAnimationFrame(tick);
    };
    rafId = requestAnimationFrame(tick);
  }

  function gradeAnswer(choice, timeout=false){
    const q = questions[idx];
    const ok = !timeout && choice === q.ppe;
    if (ok) score += 1;

    scoreEl.textContent = String(score);
    showOverlay(ok, q, choice ?? "none_selected");

    // ë‹¤ìŒ ë¬¸ì œ ìë™
    setTimeout(() => {
      hideOverlay();
      nextQuestion();
    }, AFTER_FEEDBACK_MS);
  }

  function nextQuestion(){
    idx += 1;
    if (idx >= questions.length){
      finishGame();
      return;
    }
    // ë‹¤ìŒ ë¬¸ì œ ì‹œì‘
    setState("ë‹¤ìŒ");
    setTimeout(() => startQuestion(), 150);
  }

  function finishGame(){
    running = false;
    cancelAnimationFrame(rafId);
    fallItem.style.display = "none";
    hintText.textContent = `ì™„ë£Œ! ì ìˆ˜: ${score}/${questions.length}`;
    setState("ì™„ë£Œ");
    setTime(FALL_SECONDS);
    // ë§ˆì§€ë§‰ ê²°ê³¼ ì´ë¯¸ì§€ë§Œ ë³´ì—¬ì£¼ê³  ë
    setResultImage(IMG_IDLE);
  }

  // ===== ë²„íŠ¼ ì´ë²¤íŠ¸ =====
  document.querySelectorAll(".btn").forEach(btn => {
    btn.addEventListener("click", () => {
      if (!running || answered) return;
      answered = true;
      running = false;
      setState("ì±„ì ");
      cancelAnimationFrame(rafId);
      const choice = btn.dataset.ppe;
      gradeAnswer(choice, false);
    }, { passive:true });
  });

  // ===== ìë™ ì‹œì‘ =====
  qNowEl.textContent = "0";
  scoreEl.textContent = "0";
  setState("ì‹œì‘");
  setTime(FALL_SECONDS);
  hintText.textContent = "ìë™ìœ¼ë¡œ ì‹œì‘í•©ë‹ˆë‹¤â€¦";
  setResultImage(IMG_IDLE);

  setTimeout(() => {
    hintText.textContent = "";
    startQuestion();
  }, 350);

})();
</script>
</body>
</html>
