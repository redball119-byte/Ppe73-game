<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ (ì§ˆë³‘ëª… ë‚™í•˜)</title>
  <style>
    :root{
      --bg:#071022;
      --card:rgba(255,255,255,.07);
      --stroke:rgba(255,255,255,.14);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.68);
      --good:#22c55e;
      --bad:#ef4444;
      --btn:#2b3b55;
      --btn2:#1f2c44;
      --shadow:0 18px 40px rgba(0,0,0,.35);
      --r:22px;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,Apple SD Gothic Neo,sans-serif; background:radial-gradient(1200px 800px at 50% 0%, #1a2a44 0%, var(--bg) 55%); color:var(--text); }
    body{ padding:14px 14px calc(env(safe-area-inset-bottom) + 14px); }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      display:grid;
      gap:12px;
    }

    /* ìƒë‹¨ ì¹´ë“œ 3ê°œ */
    .top{
      display:grid;
      grid-template-columns: 1.25fr .8fr .8fr;
      gap:12px;
    }
    .card{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:14px;
      backdrop-filter: blur(10px);
    }
    .titleBig{ font-size:20px; font-weight:800; letter-spacing:-.3px; line-height:1.15; }
    .sub{ margin-top:6px; font-size:12px; color:var(--muted); }
    .stat{ display:flex; align-items:center; justify-content:center; height:100%; text-align:center; }
    .stat .k{ font-size:13px; color:var(--muted); }
    .stat .v{ font-size:28px; font-weight:900; margin-top:6px; }

    /* ì•ˆë‚´ ì¹´ë“œ */
    .guide .h{ font-weight:800; font-size:18px; margin-bottom:8px; }
    .guide .p{ font-size:13px; color:var(--muted); line-height:1.5; margin:6px 0; }

    /* ê²Œì„ ì˜ì—­(ë¬¸ì œ ë°•ìŠ¤) */
    .gameCard{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:12px;
      backdrop-filter: blur(10px);
    }

    .rowInfo{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .pill{
      flex:1;
      background:rgba(255,255,255,.06);
      border:1px solid var(--stroke);
      border-radius:999px;
      padding:10px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      min-width:0;
    }
    .pill b{ font-size:14px; }
    .pill span{ color:var(--muted); font-size:13px; }

    /* âœ… ë¬¸ì œ ë°•ìŠ¤: í™”ë©´ì—ì„œ ì ˆëŒ€ ì•ˆ ì˜ë¦¬ê²Œ â€œê³ ì • ë†’ì´ + ë‚´ë¶€ ì •ë ¬â€ */
    .dropZone{
      border-radius:20px;
      border:2px dashed rgba(255,255,255,.18);
      background:rgba(0,0,0,.15);
      height: clamp(180px, 28vh, 260px); /* í•µì‹¬: ë„ˆë¬´ ì‘ì•„ì§€ì§€ ì•Šê²Œ */
      position:relative;
      overflow:hidden;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:16px;
    }

    /* ë‚™í•˜í•˜ëŠ” í…ìŠ¤íŠ¸ */
    .falling{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      top:-80px;
      width:min(92%, 560px);
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.18);
      border-radius:18px;
      padding:16px 18px;
      text-align:center;
      font-weight:900;
      font-size: clamp(18px, 5vw, 30px); /* ê¸€ì”¨ê°€ ê¸¸ì–´ë„ í™”ë©´ì— ë§ì¶¤ */
      letter-spacing:-.5px;
      line-height:1.15;
      text-shadow:0 6px 18px rgba(0,0,0,.35);
      user-select:none;
    }

    /* ì •ë‹µ/ì˜¤ë‹µ ì´ë¯¸ì§€(ì‘ê²Œ ì¤‘ì•™) */
    .resultStamp{
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%, -50%);
      width: min(150px, 40vw);
      height:auto;
      display:none;
      pointer-events:none;
      filter: drop-shadow(0 18px 24px rgba(0,0,0,.45));
    }

    /* ì¬ì‹œì‘ ë²„íŠ¼(ì‘ê²Œ) */
    .restartBtn{
      border:none;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.16);
      color:var(--text);
      padding:9px 12px;
      border-radius:14px;
      font-weight:800;
      font-size:13px;
      cursor:pointer;
      white-space:nowrap;
    }
    .restartBtn:active{ transform:scale(.98); }

    /* ë³´í˜¸êµ¬ ì˜ì—­ */
    .ppeHead{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      padding:10px 4px 0;
      margin-top:8px;
    }
    .ppeHead .l{ font-weight:900; font-size:20px; }
    .ppeHead .r{ color:var(--muted); font-size:13px; }

    /* âœ… ë³´í˜¸êµ¬ 4ê°œ â€œí•­ìƒ 2x2â€ + ì•„ë˜ê°€ ì•ˆ ì˜ë¦¬ê²Œ */
    .ppeGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:10px;
      padding-bottom: 6px;
    }
    .btn{
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.16);
      border-radius:22px;
      padding:14px 14px;
      min-height:88px; /* ë„ˆë¬´ ì»¤ì„œ ë‹µë‹µí•˜ì§€ ì•Šê²Œ ì ë‹¹íˆ */
      text-align:center;
      cursor:pointer;
      box-shadow: 0 14px 30px rgba(0,0,0,.28);
    }
    .btn .t{ font-size:20px; font-weight:900; letter-spacing:-.3px; }
    .btn .d{ margin-top:6px; font-size:13px; color:var(--muted); }
    .btn:active{ transform:scale(.99); }
    .btn.disabled{ opacity:.55; cursor:not-allowed; }

    /* ì‘ì€ í™”ë©´ì—ì„œ ì¹´ë“œ ì—¬ë°± ì¡°ê¸ˆ ì¤„ì´ê¸° */
    @media (max-width:420px){
      body{ padding:12px 12px calc(env(safe-area-inset-bottom) + 12px); }
      .card{ padding:12px; }
      .btn{ min-height:82px; }
      .btn .t{ font-size:19px; }
      .btn .d{ font-size:12px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="card">
        <div class="titleBig">ğŸ§¹ í™˜ê²½ê´€ë¦¬<br/>PPE í€´ì¦ˆ</div>
        <div class="sub" id="modeTxt">ê¸°ë³¸ 4ì¢… Â· ì§ˆë³‘ëª… ë‚™í•˜</div>
      </div>

      <div class="card stat">
        <div>
          <div class="k">ë¬¸í•­</div>
          <div class="v"><span id="qNow">1</span>/<span id="qTotal">10</span></div>
        </div>
      </div>

      <div class="card stat">
        <div>
          <div class="k">ì ìˆ˜</div>
          <div class="v" id="score">0</div>
        </div>
      </div>
    </div>

    <div class="card guide">
      <div class="h">ì§ˆë³‘/ìƒí™©ì„ ë³´ê³  í•„ìš”í•œ PPE 1ê°œë¥¼ ê³ ë¥´ì„¸ìš”</div>
      <div class="p">1) ì§ˆë³‘ëª…ì´ ë„¤ëª¨ì¹¸ ìœ„ì—ì„œ ì•„ë˜ë¡œ <b>5ì´ˆ</b> ë™ì•ˆ ë‚´ë ¤ì˜µë‹ˆë‹¤. (ì‹œê°„ ì´ˆê³¼ ì‹œ ì˜¤ë‹µ)</div>
      <div class="p">2) ì•„ë˜ì—ì„œ PPE 1ê°œë¥¼ ëˆ„ë¥´ë©´ ìë™ ì±„ì  í›„ <b>ìë™ìœ¼ë¡œ ë‹¤ìŒ ë¬¸ì œ</b>ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.</div>
    </div>

    <div class="gameCard">
      <div class="rowInfo">
        <div class="pill"><span>â³ ì œí•œì‹œê°„</span><b id="timeLeft">5.0s</b></div>
        <div class="pill"><span>ìƒíƒœ</span><b id="state">ì§„í–‰</b></div>
        <button class="restartBtn" id="restartBtn">â†» ì¬ì‹œì‘</button>
      </div>

      <div class="dropZone" id="dropZone">
        <div class="falling" id="falling">ì‹œì‘í•˜ë©´ ë¬¸ì œê°€ ìë™ìœ¼ë¡œ ë‚˜ì˜µë‹ˆë‹¤</div>
        <img class="resultStamp" id="stamp" alt="result" />
      </div>

      <div class="ppeHead">
        <div class="l">ë³´í˜¸êµ¬ ì„ íƒ (4ê°œ)</div>
        <div class="r">í•œ ë¬¸ì œë‹¹ 1ê°œë§Œ ì„ íƒ</div>
      </div>

      <div class="ppeGrid">
        <button class="btn" data-choice="mask">
          <div class="t">ë§ˆìŠ¤í¬</div>
          <div class="d">ê¸°ë³¸(ë¹„ë§/ë¶„ë¬´)</div>
        </button>
        <button class="btn" data-choice="n95">
          <div class="t">N95 ë§ˆìŠ¤í¬</div>
          <div class="d">ê³µê¸°(ê²°í•µ ë“±)</div>
        </button>
        <button class="btn" data-choice="gown_gloves">
          <div class="t">ê°€ìš´+ì¥ê°‘</div>
          <div class="d">ì ‘ì´‰(ì˜¤ì—¼ë¬¼ ì²˜ë¦¬)</div>
        </button>
        <button class="btn" data-choice="none">
          <div class="t">PPE ë¶ˆí•„ìš”</div>
          <div class="d">ìœ„í—˜ ë‚®ìŒ(êµìœ¡ìš©)</div>
        </button>
      </div>
    </div>
  </div>

<script>
/**
 * âœ… í•µì‹¬ ìš”êµ¬ì‚¬í•­ ë°˜ì˜
 * - ì‹œì‘ë²„íŠ¼ ì—†ìŒ: í˜ì´ì§€ ë¡œë“œ í›„ ìë™ìœ¼ë¡œ 1ë²ˆ ë¬¸ì œ ì‹œì‘
 * - ì œí•œì‹œê°„ 5ì´ˆ ê³ ì • (ì›í•˜ë©´ ì—¬ê¸°ë§Œ ë°”ê¾¸ë©´ ë¨)
 * - ì„ íƒí•˜ë©´ ë°”ë¡œ ì±„ì  -> 0.7ì´ˆ ì •ë„ ê²°ê³¼ ë³´ì—¬ì£¼ê³  -> ìë™ ë‹¤ìŒ ë¬¸ì œ
 * - ì •ë‹µ/ì˜¤ë‹µ ì•„ë˜ ê¸´ ì„¤ëª… ì œê±° (ì´ë¯¸ì§€/ìŠ¤íƒ¬í”„ë§Œ í‘œì‹œ)
 * - ë³´í˜¸êµ¬ 4ê°œ í•­ìƒ í™”ë©´ì— ë³´ì´ë„ë¡ ë ˆì´ì•„ì›ƒ/ë†’ì´ ì¡°ì •
 */

const FALL_SECONDS = 5;        // âœ… 5ì´ˆ
const NEXT_DELAY_MS = 700;     // ê²°ê³¼ í‘œì‹œ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°€ëŠ” ë”œë ˆì´
const TOTAL = 10;

const assets = {
  correct: "./assets/correct.png",
  wrong: "./assets/wrong.png",
  idle: "./assets/idle.png"
};

const questions = [
  { text:"ì¸í”Œë£¨ì—”ì í™˜ì êµ¬ì—­ ì²­ì†Œ", answer:"mask" },
  { text:"ê²°í•µ ë³‘ì‹¤ ì²­ì†Œ", answer:"n95" },
  { text:"VRE/CRE ì¥ê¸° ì¬ì‹¤ ë³‘ì‹¤ í‡´ì‹¤ í›„ ì²­ì†Œ", answer:"gown_gloves" },
  { text:"ìƒì²˜ ë°°ë†/ì‚¼ì¶œë¬¼ ì£¼ë³€ ì²­ì†Œ", answer:"gown_gloves" },
  { text:"ê°ì—¼ ì˜ì‹¬ í™˜ì ì ‘ìˆ˜ì°½êµ¬(ê±°ë¦¬ ìœ ì§€, ì§ì ‘ì ‘ì´‰ ì—†ìŒ)", answer:"mask" },
  { text:"í˜ˆì•¡/ì²´ì•¡ ì˜¤ì—¼ë¬¼(Spill) ì²˜ë¦¬", answer:"gown_gloves" },
  { text:"ì¼ë°˜ ë³µë„ ë°”ë‹¥ ê±´ì‹ ë¨¼ì§€ ì œê±°(ë¶„ë¬´/ì˜¤ì—¼ë¬¼ ì—†ìŒ)", answer:"none" },
  { text:"ê²©ë¦¬ì‹¤ ë‚´ë¶€ ì†Œë…ì œ ë¶„ë¬´ ì‘ì—…", answer:"mask" },
  { text:"êµ¬í† /ì„¤ì‚¬ í™˜ì ì£¼ë³€ ì²­ì†Œ(ì˜¤ì—¼ ê°€ëŠ¥)", answer:"gown_gloves" },
  { text:"ê³µê¸°ì£¼ì˜ ì˜ì‹¬ í™˜ì ì´ë™ í›„ í™˜ê²½ ì •ë¦¬", answer:"n95" },
];

let idx = 0;
let score = 0;

let raf = null;
let startTs = 0;
let running = false;
let answered = false;

const elQNow = document.getElementById("qNow");
const elQTotal = document.getElementById("qTotal");
const elScore = document.getElementById("score");
const elFalling = document.getElementById("falling");
const elTime = document.getElementById("timeLeft");
const elState = document.getElementById("state");
const elStamp = document.getElementById("stamp");
const btns = Array.from(document.querySelectorAll(".btn"));
const restartBtn = document.getElementById("restartBtn");
const dropZone = document.getElementById("dropZone");

elQTotal.textContent = TOTAL;

function setButtonsEnabled(on){
  btns.forEach(b=>{
    b.classList.toggle("disabled", !on);
    b.disabled = !on;
  });
}

function showStamp(type){ // "correct" | "wrong" | "idle" | null
  if(!type){ elStamp.style.display="none"; return; }
  elStamp.src = assets[type] || assets.idle;
  elStamp.style.display="block";
}

function resetFallingPosition(){
  elFalling.style.top = "-90px";
}

function startQuestion(){
  if(raf) cancelAnimationFrame(raf);
  running = true;
  answered = false;
  setButtonsEnabled(true);
  showStamp(null);

  elQNow.textContent = (idx+1).toString();
  elState.textContent = "ì§„í–‰";
  elTime.textContent = FALL_SECONDS.toFixed(1) + "s";

  elFalling.textContent = questions[idx]?.text || "ì™„ë£Œ";
  resetFallingPosition();

  // dropZone ë†’ì´ ì•ˆì—ì„œ ë‚´ë ¤ì˜¤ê²Œ
  const zoneH = dropZone.clientHeight;
  const targetTop = zoneH - 90; // ë„ˆë¬´ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ë©´ ì˜ë¦¬ë‹ˆê¹Œ ì—¬ìœ 
  startTs = performance.now();

  const tick = (t)=>{
    if(!running) return;

    const elapsed = (t - startTs) / 1000;
    const left = Math.max(0, FALL_SECONDS - elapsed);
    elTime.textContent = left.toFixed(1) + "s";

    // 0~1 ì§„í–‰ë¥ 
    const p = Math.min(1, elapsed / FALL_SECONDS);
    const y = -90 + p * (targetTop + 90);
    elFalling.style.top = y + "px";

    if(elapsed >= FALL_SECONDS){
      // ì‹œê°„ì´ˆê³¼ => ì˜¤ë‹µ ì²˜ë¦¬
      timeOutWrong();
      return;
    }
    raf = requestAnimationFrame(tick);
  };
  raf = requestAnimationFrame(tick);
}

function timeOutWrong(){
  if(answered) return;
  answered = true;
  running = false;
  setButtonsEnabled(false);
  elState.textContent = "ì˜¤ë‹µ";
  showStamp("wrong");

  // ë‹¤ìŒ ë¬¸ì œ ìë™
  setTimeout(nextQuestion, NEXT_DELAY_MS);
}

function answer(choice){
  if(answered) return;
  answered = true;
  running = false;
  setButtonsEnabled(false);

  const ok = (choice === questions[idx].answer);
  if(ok){
    score += 1;
    elScore.textContent = score.toString();
    elState.textContent = "ì •ë‹µ";
    showStamp("correct");
  }else{
    elState.textContent = "ì˜¤ë‹µ";
    showStamp("wrong");
  }

  setTimeout(nextQuestion, NEXT_DELAY_MS);
}

function nextQuestion(){
  idx += 1;
  if(idx >= TOTAL){
    finish();
    return;
  }
  startQuestion();
}

function finish(){
  if(raf) cancelAnimationFrame(raf);
  running = false;
  answered = true;
  setButtonsEnabled(false);
  elState.textContent = "ì™„ë£Œ";
  elTime.textContent = "0.0s";
  elFalling.textContent = "ë! ì¬ì‹œì‘ì„ ëˆŒëŸ¬ ë‹¤ì‹œ í•  ìˆ˜ ìˆì–´ìš”";
  elFalling.style.top = "40%";
  showStamp(null);
}

btns.forEach(b=>{
  b.addEventListener("click", ()=> answer(b.dataset.choice));
});

restartBtn.addEventListener("click", ()=>{
  idx = 0;
  score = 0;
  elScore.textContent = "0";
  startQuestion();
});

// âœ… í˜ì´ì§€ ë¡œë“œ í›„ ìë™ ì‹œì‘
window.addEventListener("load", ()=>{
  // í˜¹ì‹œ ì´ë¯¸ì§€ ê²½ë¡œ ë¬¸ì œë©´ idleë¼ë„ preload
  const img = new Image();
  img.src = assets.idle;
  startQuestion();
});
</script>
</body>
</html>
