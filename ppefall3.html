<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ (ê¸°ë³¸ 4ì¢… Â· ì§ˆë³‘ëª… ë‚™í•˜)</title>

  <style>
    :root{
      --bg:#071022;
      --card:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.14);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.72);
      --good:#22c55e;
      --bad:#ef4444;
      --shadow: 0 18px 40px rgba(0,0,0,.45);
      --r:22px;
    }
    *{box-sizing:border-box;}
    html,body{height:100%;}
    body{
      margin:0;
      background: radial-gradient(1200px 700px at 30% 10%, rgba(90,140,255,.18), transparent 60%),
                  radial-gradient(900px 500px at 80% 30%, rgba(60,200,160,.10), transparent 60%),
                  var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, "Pretendard", "Noto Sans KR", sans-serif;
      overflow:hidden; /* í™”ë©´ ë°– ìŠ¤í¬ë¡¤ë¡œ ë²„íŠ¼ ì•ˆ ë³´ì´ëŠ” ë¬¸ì œ ë°©ì§€ */
    }

    /* ì•ˆì „ì˜ì—­(ì•„ì´í° ë…¸ì¹˜ ë“±) */
    .safe{
      height:100dvh;
      padding:
        calc(env(safe-area-inset-top) + 12px)
        calc(env(safe-area-inset-right) + 12px)
        calc(env(safe-area-inset-bottom) + 12px)
        calc(env(safe-area-inset-left) + 12px);
      display:flex;
    }

    .app{
      width:min(520px, 100%);
      margin:0 auto;
      display:flex;
      flex-direction:column;
      gap:12px;
      flex:1;
      min-height:0; /* flex overflow ë°©ì§€ */
    }

    .rowTop{
      display:grid;
      grid-template-columns: 1.35fr .9fr .9fr;
      gap:12px;
      align-items:stretch;
    }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding:12px 14px;
      min-height:76px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }

    .titleBox{
      display:flex; gap:10px; align-items:flex-start;
    }
    .icon{font-size:22px; line-height:1; margin-top:2px;}
    .title{
      display:flex; flex-direction:column; gap:4px;
    }
    .title .h{
      font-size: clamp(16px, 3.6vw, 18px);
      font-weight: 900;
      letter-spacing: -.2px;
      line-height:1.1;
    }
    .title .sub{
      font-size: clamp(11px, 2.8vw, 12px);
      color: var(--muted);
      line-height:1.2;
    }

    .mini{
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      text-align:center;
      gap:6px;
    }
    .mini .k{font-size:12px; color:var(--muted); font-weight:700;}
    .mini .v{font-size: clamp(18px, 4vw, 22px); font-weight:900;}

    .restartBtn{
      margin-left:auto;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      color: var(--text);
      padding:8px 10px;
      border-radius: 999px;
      font-weight:800;
      font-size:12px;
      cursor:pointer;
      touch-action: manipulation;
    }
    .restartBtn:active{transform: translateY(1px);}

    .guide{
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid var(--stroke);
      border-radius: var(--r);
      padding:12px 14px;
      box-shadow: var(--shadow);
    }
    .guide .h{
      font-weight:900;
      font-size: clamp(15px, 3.8vw, 18px);
      margin:0 0 6px;
      letter-spacing:-.2px;
    }
    .guide ol{
      margin:0;
      padding-left: 18px;
      color: var(--muted);
      font-size: clamp(12px, 3.1vw, 13px);
      line-height:1.4;
    }
    .guide li{margin:4px 0;}

    /* ìƒíƒœë°” */
    .statusBar{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    .pill{
      background:rgba(255,255,255,.08);
      border:1px solid var(--stroke);
      border-radius:999px;
      padding:10px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      box-shadow: var(--shadow);
    }
    .pill .k{color:var(--muted); font-size:12px; font-weight:800;}
    .pill .v{font-weight:900; font-size: clamp(14px, 3.5vw, 16px);}

    /* ë‚™í•˜ ë°•ìŠ¤: ë‚¨ëŠ” ê³µê°„ì„ ìµœëŒ€ í™œìš© */
    .dropWrap{
      flex: 1;
      min-height: 170px;
      background: linear-gradient(180deg, rgba(0,0,0,.25), rgba(255,255,255,.03));
      border:1px dashed rgba(255,255,255,.22);
      border-radius: var(--r);
      position:relative;
      overflow:hidden; /* ë‚´ë¶€ë§Œ ìˆ¨ê¹€. í…ìŠ¤íŠ¸ëŠ” ë°•ìŠ¤ ì•ˆì—ì„œ ì¤„ë°”ê¿ˆ ì²˜ë¦¬ */
      box-shadow: var(--shadow);
    }

    .dropLabel{
      position:absolute;
      left: 50%;
      top: 0;
      transform: translate(-50%, -120%);
      opacity:.0;
      pointer-events:none;
    }

    .fall{
      position:absolute;
      left: 50%;
      top: 0;
      transform: translate(-50%, -120%);
      width: min(92%, 460px);
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.16);
      border-radius: 18px;
      padding: 14px 16px;
      text-align:center;
      box-shadow: 0 14px 30px rgba(0,0,0,.35);
      will-change: transform;
    }
    .fallText{
      margin:0;
      font-weight: 950;
      letter-spacing:-.4px;
      line-height:1.15;
      /* í•µì‹¬: ê¸¸ë©´ ì¤„ë°”ê¿ˆ + ìµœëŒ€ 2ì¤„ê¹Œì§€ ìì—°ìŠ¤ëŸ½ê²Œ */
      white-space: normal;
      word-break: keep-all;
      overflow-wrap: anywhere;
      font-size: clamp(16px, 5.4vw, 28px);
    }

    /* ê²°ê³¼ í‘œì‹œ: ê¸€ë§Œ(ì„¤ëª… ì œê±°) */
    .result{
      position:absolute;
      left:50%;
      top:50%;
      transform: translate(-50%,-50%);
      text-align:center;
      pointer-events:none;
      opacity:0;
      transition: opacity .15s ease;
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:center;
    }
    .result.show{opacity:1;}
    .badge{
      font-weight: 950;
      font-size: clamp(22px, 6vw, 34px);
      letter-spacing:-.3px;
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.25);
    }
    .badge.good{color: var(--good);}
    .badge.bad{color: var(--bad);}

    /* ë³´í˜¸êµ¬ ì˜ì—­: í•­ìƒ 2Ã—2 ë³´ì´ê²Œ 'ê³ ì • ë†’ì´' í™•ë³´ */
    .ppeHeader{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      margin-top: 2px;
      gap:10px;
    }
    .ppeHeader .h{
      font-size: clamp(15px, 3.8vw, 18px);
      font-weight: 950;
      letter-spacing:-.2px;
    }
    .ppeHeader .sub{
      font-size: clamp(11px, 2.9vw, 12px);
      color: var(--muted);
      font-weight:800;
      white-space:nowrap;
    }

    .ppeGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;

      /* âœ… ì´ ì¤„ì´ í•µì‹¬: ì•„ë˜ 2ì¹¸ì´ ì•ˆ ë³´ì´ëŠ” ë¬¸ì œë¥¼ ê°•ì œë¡œ í•´ê²° */
      flex: 0 0 auto;

      /* í™”ë©´ì´ ì‘ì•„ë„ 2ì¤„ì´ ë³´ì´ë„ë¡ ë²„íŠ¼ ë†’ì´ë¥¼ clampë¡œ ì œì–´ */
    }

    .ppeBtn{
      border-radius: 22px;
      background: rgba(255,255,255,.07);
      border: 1px solid rgba(255,255,255,.14);
      padding: 14px 12px;
      text-align:center;
      box-shadow: var(--shadow);
      cursor:pointer;
      touch-action: manipulation;
      user-select:none;
      min-height: clamp(76px, 12.5vh, 92px); /* ë„ˆë¬´ ì»¤ì ¸ì„œ ë‹µë‹µí•œ ê²ƒë„ ë°©ì§€ */
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:6px;
    }
    .ppeBtn:active{transform: translateY(1px);}
    .ppeBtn[disabled]{
      opacity:.55;
      filter:saturate(.9);
      cursor:not-allowed;
    }
    .ppeBtn .t{
      font-weight:950;
      font-size: clamp(14px, 3.8vw, 18px);
      letter-spacing:-.2px;
    }
    .ppeBtn .d{
      color: var(--muted);
      font-weight:800;
      font-size: clamp(11px, 2.9vw, 12px);
      line-height:1.2;
    }

    .foot{
      color: rgba(234,240,255,.58);
      font-size: 11px;
      text-align:center;
      margin-top: 2px;
    }
  </style>
</head>

<body>
  <div class="safe">
    <div class="app">

      <!-- ìƒë‹¨ -->
      <div class="rowTop">
        <div class="card">
          <div class="titleBox">
            <div class="icon">ğŸ§¹</div>
            <div class="title">
              <div class="h">í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ</div>
              <div class="sub">ê¸°ë³¸ 4ì¢… Â· ì§ˆë³‘ëª… ë‚™í•˜</div>
            </div>
          </div>
          <button class="restartBtn" id="restartBtn" type="button">â†» ì¬ì‹œì‘</button>
        </div>

        <div class="card mini">
          <div class="k">ë¬¸í•­</div>
          <div class="v" id="qText">1/10</div>
        </div>

        <div class="card mini">
          <div class="k">ì ìˆ˜</div>
          <div class="v" id="scoreText">0</div>
        </div>
      </div>

      <!-- ì•ˆë‚´ -->
      <div class="guide">
        <p class="h">ì§ˆë³‘/ìƒí™©ì„ ë³´ê³  í•„ìš”í•œ PPE 1ê°œë¥¼ ê³ ë¥´ì„¸ìš”</p>
        <ol>
          <li>ì§ˆë³‘ëª…ì´ ë„¤ëª¨ì¹¸ ìœ„ì—ì„œ ì•„ë˜ë¡œ <b>5ì´ˆ</b> ë™ì•ˆ ë‚´ë ¤ì˜µë‹ˆë‹¤. (ì‹œê°„ ì´ˆê³¼ ì‹œ ì˜¤ë‹µ)</li>
          <li>ì•„ë˜ì—ì„œ PPE 1ê°œë¥¼ ëˆ„ë¥´ë©´ ìë™ ì±„ì  í›„ <b>ìë™ìœ¼ë¡œ ë‹¤ìŒ ë¬¸ì œ</b>ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.</li>
        </ol>
      </div>

      <!-- ìƒíƒœ -->
      <div class="statusBar">
        <div class="pill">
          <div class="k">â³ ì œí•œì‹œê°„</div>
          <div class="v" id="timeText">5.0s</div>
        </div>
        <div class="pill">
          <div class="k">ìƒíƒœ</div>
          <div class="v" id="stateText">ëŒ€ê¸°</div>
        </div>
      </div>

      <!-- ë‚™í•˜ ë°•ìŠ¤ -->
      <div class="dropWrap" id="dropWrap">
        <div class="result" id="result">
          <div class="badge good" id="badge">ì •ë‹µ âœ…</div>
        </div>
        <div class="fall" id="fall" aria-live="polite">
          <p class="fallText" id="fallText">ì‹œì‘í•˜ë©´ ë‚´ë ¤ì˜µë‹ˆë‹¤</p>
        </div>
      </div>

      <!-- ë³´í˜¸êµ¬ -->
      <div class="ppeHeader">
        <div class="h">ë³´í˜¸êµ¬ ì„ íƒ (4ê°œ)</div>
        <div class="sub">í•œ ë¬¸ì œë‹¹ 1ê°œë§Œ ì„ íƒ</div>
      </div>

      <div class="ppeGrid" id="ppeGrid">
        <button class="ppeBtn" data-choice="mask" type="button">
          <div class="t">ë§ˆìŠ¤í¬</div>
          <div class="d">ê¸°ë³¸(ë¹„ë§/ë¶„ë¬´)</div>
        </button>
        <button class="ppeBtn" data-choice="n95" type="button">
          <div class="t">N95 ë§ˆìŠ¤í¬</div>
          <div class="d">ê³µê¸°(ê²°í•µ ë“±)</div>
        </button>
        <button class="ppeBtn" data-choice="gown" type="button">
          <div class="t">ê°€ìš´+ì¥ê°‘</div>
          <div class="d">ì ‘ì´‰(ì˜¤ì—¼ë¬¼ ì²˜ë¦¬)</div>
        </button>
        <button class="ppeBtn" data-choice="none" type="button">
          <div class="t">PPE ë¶ˆí•„ìš”</div>
          <div class="d">ìœ„í—˜ ë‚®ìŒ(êµìœ¡ìš©)</div>
        </button>
      </div>

      <div class="foot">â€» êµìœ¡ìš© ë‹¨ìˆœí™” ë²„ì „(í‘œì¤€ì£¼ì˜+ì¶”ê°€ì£¼ì˜ ê°œë… ê¸°ë°˜)</div>
    </div>
  </div>

  <script>
    /***********************
     * ë¬¸ì œ ë°ì´í„°(ì˜ˆì‹œ)
     * - answer: 'mask' | 'n95' | 'gown' | 'none'
     ***********************/
    const QUESTIONS = [
      { text: "ì¸í”Œë£¨ì—”ì í™˜ì êµ¬ì—­ ì²­ì†Œ", answer: "mask" },
      { text: "ê²°í•µ ë³‘ì‹¤ ì²­ì†Œ", answer: "n95" },
      { text: "VRE/CRE ì¥ê¸° ì¬ì‹¤ ë³‘ì‹¤ í‡´ì‹¤ í›„ ì²­ì†Œ", answer: "gown" },
      { text: "ì„¤ì‚¬/êµ¬í†  í™˜ì ì£¼ë³€ ì˜¤ì—¼ë¬¼ ì²˜ë¦¬", answer: "gown" },
      { text: "ìˆ˜ë‘/í™ì—­ ì˜ì‹¬ í™˜ì êµ¬ì—­ ì²­ì†Œ", answer: "n95" },
      { text: "ë‹¨ìˆœ ë¨¼ì§€ ì œê±°(ì˜¤ì—¼ ì—†ìŒ)", answer: "none" },
      { text: "MRSA í™˜ì ë³‘ì‹¤ í™˜ê²½ í‘œë©´ ì²­ì†Œ", answer: "gown" },
      { text: "ê¸°ì¹¨/ê°€ë˜ ë§ì€ í™˜ì ì£¼ë³€ ì²­ì†Œ", answer: "mask" },
      { text: "í˜ˆì•¡/ì²´ì•¡ ì˜¤ì—¼ë¬¼ ì²˜ë¦¬", answer: "gown" },
      { text: "ê²©ë¦¬ì‹¤ ë°”ë‹¥ ì²­ì†Œ(ê³µê¸°ì£¼ì˜)", answer: "n95" },
    ];

    // ì„¤ì •
    const FALL_SECONDS = 5.0;       // âœ… 5ì´ˆ ë‚™í•˜
    const NEXT_DELAY_MS = 700;      // ì±„ì  í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°€ê¸° ë”œë ˆì´

    // DOM
    const qText = document.getElementById("qText");
    const scoreText = document.getElementById("scoreText");
    const timeText = document.getElementById("timeText");
    const stateText = document.getElementById("stateText");
    const fall = document.getElementById("fall");
    const fallText = document.getElementById("fallText");
    const dropWrap = document.getElementById("dropWrap");
    const ppeGrid = document.getElementById("ppeGrid");
    const btns = Array.from(ppeGrid.querySelectorAll(".ppeBtn"));
    const result = document.getElementById("result");
    const badge = document.getElementById("badge");
    const restartBtn = document.getElementById("restartBtn");

    // state
    let idx = 0;
    let score = 0;
    let running = false;
    let answered = false;
    let rafId = null;
    let startTs = 0;

    function setButtonsEnabled(enabled){
      btns.forEach(b => b.disabled = !enabled);
    }

    function showResult(isCorrect){
      result.classList.add("show");
      badge.classList.toggle("good", isCorrect);
      badge.classList.toggle("bad", !isCorrect);
      badge.textContent = isCorrect ? "ì •ë‹µ âœ…" : "ì˜¤ë‹µ âŒ";
    }

    function hideResult(){
      result.classList.remove("show");
    }

    // í…ìŠ¤íŠ¸ê°€ ê¸¸ë©´ ìë™ìœ¼ë¡œ ë” ì¤„ì´ê¸°(ë°•ìŠ¤ ë°–ìœ¼ë¡œ ì˜ë¦¬ëŠ” ê²ƒ ë°©ì§€)
    function fitFallText(){
      const maxPx = 28;  // CSS clamp ìƒí•œê³¼ ë§ì¶¤
      const minPx = 14;
      let size = maxPx;

      fallText.style.fontSize = size + "px";
      // fall padding í¬í•¨í•œ ë‚´ë¶€ ë†’ì´ ëŒ€ë¹„ ì²´í¬
      const wrapH = dropWrap.clientHeight;
      const safeH = Math.max(90, wrapH * 0.38); // ë„ˆë¬´ í° ê¸€ë¡œ 3~4ì¤„ ìƒê¸°ë©´ ì¶•ì†Œ
      while (size > minPx && fall.offsetHeight > safeH){
        size -= 1;
        fallText.style.fontSize = size + "px";
      }
    }

    function layoutFallAtTop(){
      fall.style.transform = "translate(-50%, -120%)";
    }

    function startQuestion(){
      if (idx >= QUESTIONS.length){
        stateText.textContent = "ì™„ë£Œ";
        running = false;
        setButtonsEnabled(false);
        return;
      }

      hideResult();
      answered = false;
      running = true;
      setButtonsEnabled(true);
      stateText.textContent = "ì§„í–‰";

      // ë¬¸ì œ í‘œì‹œ
      qText.textContent = `${idx+1}/${QUESTIONS.length}`;
      fallText.textContent = QUESTIONS[idx].text;

      // í…ìŠ¤íŠ¸ í¬ê¸° ë§ì¶”ê³  ì‹œì‘ ìœ„ì¹˜
      fitFallText();
      layoutFallAtTop();

      // ì• ë‹ˆë©”ì´ì…˜ ê¸°ì¤€ê°’
      startTs = performance.now();

      // ì• ë‹ˆë©”ì´ì…˜: ë°•ìŠ¤ ìœ„ -> ë°•ìŠ¤ ì•„ë˜(í…ìŠ¤íŠ¸ê°€ ë°•ìŠ¤ ì•ˆì—ì„œ ëë‚˜ë„ë¡ ê³„ì‚°)
      cancelAnimationFrame(rafId);
      const boxH = dropWrap.clientHeight;
      const elH = fall.offsetHeight;
      const topY = -elH - 14;
      const bottomY = boxH - elH - 16; // âœ… ì•„ë˜ì—ì„œ ì•ˆ ì˜ë¦¬ê²Œ ì—¬ë°±

      function tick(now){
        if (!running) return;

        const t = (now - startTs) / (FALL_SECONDS * 1000);
        const clamped = Math.min(Math.max(t, 0), 1);
        const y = topY + (bottomY - topY) * clamped;
        fall.style.transform = `translate(-50%, ${y}px)`;

        const remain = Math.max(0, FALL_SECONDS - (now - startTs)/1000);
        timeText.textContent = remain.toFixed(1) + "s";

        if (clamped >= 1 && !answered){
          // ì‹œê°„ ì´ˆê³¼ = ì˜¤ë‹µ ì²˜ë¦¬
          answered = true;
          running = false;
          setButtonsEnabled(false);
          stateText.textContent = "ì˜¤ë‹µ";
          showResult(false);

          setTimeout(nextQuestion, NEXT_DELAY_MS);
          return;
        }

        rafId = requestAnimationFrame(tick);
      }

      rafId = requestAnimationFrame(tick);
    }

    function nextQuestion(){
      idx += 1;
      running = false;
      answered = false;
      startQuestion(); // âœ… ìë™ ë‹¤ìŒ ë¬¸ì œ
    }

    function answer(choice){
      if (!running || answered) return;

      answered = true;
      running = false;
      setButtonsEnabled(false);

      const correct = QUESTIONS[idx].answer === choice;
      if (correct) score += 1;

      scoreText.textContent = score;
      stateText.textContent = correct ? "ì •ë‹µ" : "ì˜¤ë‹µ";
      showResult(correct);

      setTimeout(nextQuestion, NEXT_DELAY_MS);
    }

    // ì´ë²¤íŠ¸
    btns.forEach(b=>{
      b.addEventListener("click", ()=>{
        answer(b.dataset.choice);
      });
    });

    restartBtn.addEventListener("click", ()=>{
      // ì „ì²´ ì¬ì‹œì‘
      idx = 0;
      score = 0;
      scoreText.textContent = score;
      stateText.textContent = "ëŒ€ê¸°";
      timeText.textContent = FALL_SECONDS.toFixed(1) + "s";
      running = false;
      answered = false;
      setButtonsEnabled(true);
      hideResult();
      startQuestion();
    });

    // í™”ë©´ íšŒì „/ì£¼ì†Œì°½ ë†’ì´ ë³€í™” ëŒ€ì‘
    window.addEventListener("resize", ()=>{
      // í˜„ì¬ ë¬¸ì œ ë‹¤ì‹œ ë§ì¶”ê¸° (ì§„í–‰ ì¤‘ì´ë©´ ìœ ì§€)
      if (idx < QUESTIONS.length){
        fitFallText();
      }
    });

    // âœ… ì‹œì‘ ë²„íŠ¼ ì—†ì´ ìë™ ì‹œì‘
    scoreText.textContent = "0";
    timeText.textContent = FALL_SECONDS.toFixed(1) + "s";
    setTimeout(startQuestion, 250);
  </script>
</body>
</html>
