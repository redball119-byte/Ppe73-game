<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
  <title>í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ</title>
  <style>
    :root{
      --bg1:#071022;
      --bg2:#020617;
      --card:rgba(255,255,255,.07);
      --stroke:rgba(255,255,255,.16);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.72);
      --good:#22c55e;
      --bad:#ff4d4d;
      --r:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
      background: linear-gradient(180deg,var(--bg1),var(--bg2));
      color:var(--text);
      height:100vh;
      overflow:hidden;
    }

    /* ë ˆì´ì•„ì›ƒ: í™”ë©´ ì „ì²´ë¥¼ "í—¤ë” + ì•ˆë‚´ + ìƒíƒœ + ìŠ¤í…Œì´ì§€ + ë²„íŠ¼ì˜ì—­"ìœ¼ë¡œ ê³ ì • ë°°ì¹˜ */
    .wrap{
      height:100vh;
      padding: 12px 12px calc(12px + env(safe-area-inset-bottom));
      display:grid;
      grid-template-rows: auto auto auto 1fr auto;
      gap:10px;
    }

    .top{
      display:grid;
      grid-template-columns: 1.4fr 1fr 1fr;
      gap:10px;
    }
    .card{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--r);
      padding: 12px;
      backdrop-filter: blur(8px);
    }
    .title{
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .title .emoji{font-size:22px}
    .title .t1{
      font-weight:900;
      font-size:18px;
      line-height:1.15;
    }
    .title .t2{
      margin-top:6px;
      color:var(--muted);
      font-size:12px;
      line-height:1.2;
    }

    .stat{
      text-align:center;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:6px;
      padding: 10px 12px;
    }
    .stat .label{color:var(--muted); font-size:12px}
    .stat .value{font-weight:900; font-size:26px}

    .hint{
      font-weight:900;
      font-size:20px;
      line-height:1.15;
    }
    .hintSub{
      margin-top:8px;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    .statusRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .pill{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 12px 14px;
      border-radius: 999px;
    }
    .pill .left{
      display:flex;
      align-items:center;
      gap:8px;
      color:var(--muted);
      font-weight:800;
      font-size:14px;
    }
    .pill .right{
      font-weight:900;
      font-size:18px;
    }

    /* ìŠ¤í…Œì´ì§€: ë‚¨ëŠ” ê³µê°„ì„ ì „ë¶€ ì°¨ì§€. ì—¬ê¸° ì•ˆì—ì„œë§Œ ë–¨ì–´ì§ */
    .stage{
      position:relative;
      border: 2px dashed rgba(255,255,255,.18);
      border-radius: var(--r);
      overflow:hidden;
      background: rgba(0,0,0,.10);
      min-height: 210px; /* ì‘ì€ í™”ë©´ë„ ë³´ì¥ */
    }

    /* ë–¨ì–´ì§€ëŠ” í…ìŠ¤íŠ¸ ë°•ìŠ¤ */
    .fall{
      position:absolute;
      left: 50%;
      transform: translateX(-50%);
      top: -90px;
      width: min(92%, 560px);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 999px;
      padding: 16px 16px;
      text-align:center;
      font-weight: 900;
      /* í•µì‹¬: ê¸´ ì§ˆë³‘ëª…ë„ ì˜ë¦¬ì§€ ì•Šê²Œ ìë™ í¬ê¸° */
      font-size: clamp(16px, 4.6vw, 26px);
      line-height: 1.15;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
    }

    /* ê²°ê³¼ ë±ƒì§€: ì„¤ëª…ê¸€ ì—†ìŒ, "ì •ë‹µ/ì˜¤ë‹µ"ë§Œ */
    .badge{
      position:absolute;
      left:50%;
      transform: translateX(-50%);
      bottom: 14px;
      padding: 10px 14px;
      border-radius: 999px;
      font-weight: 1000;
      font-size: 22px;
      display:none;
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.16);
    }
    .badge.good{color: var(--good)}
    .badge.bad{color: var(--bad)}

    /* í•˜ë‹¨ PPE ì˜ì—­: í•­ìƒ 2x2ê°€ "í™”ë©´ ì•ˆ"ì— ë³´ì´ë„ë¡ */
    .ppeBox{
      background: rgba(0,0,0,.20);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: var(--r);
      padding: 12px;
    }
    .ppeHead{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .ppeHead .h1{font-weight:1000; font-size:22px}
    .ppeHead .h2{color:var(--muted); font-weight:800; font-size:13px}

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .btn{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: 16px;
      padding: 14px 10px;
      color: var(--text);
      text-align:center;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      min-height: 74px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:6px;
    }
    .btn .b1{
      font-weight:1000;
      font-size: clamp(15px, 4.2vw, 20px);
      line-height:1.1;
    }
    .btn .b2{
      color: var(--muted);
      font-weight:800;
      font-size: 12px;
      line-height:1.1;
    }
    .btn:active{transform: scale(.99)}

    /* ì‘ê²Œ: ì¬ì‹œì‘ ë²„íŠ¼(í™”ë©´ ë‹µë‹µí•˜ì§€ ì•Šê²Œ) */
    .restart{
      position: fixed;
      top: calc(10px + env(safe-area-inset-top));
      left: 12px;
      z-index: 50;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.16);
      border-radius: 999px;
      padding: 10px 12px;
      color: var(--text);
      font-weight: 900;
      font-size: 14px;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>
<body>
  <button class="restart" id="restartBtn">â†» ì¬ì‹œì‘</button>

  <div class="wrap">
    <div class="top">
      <div class="card">
        <div class="title">
          <div class="emoji">ğŸ§¹</div>
          <div>
            <div class="t1">í™˜ê²½ê´€ë¦¬ PPE í€´ì¦ˆ</div>
            <div class="t2">ê¸°ë³¸ 4ì¢… Â· ì§ˆë³‘ëª… ë‚™í•˜</div>
          </div>
        </div>
      </div>
      <div class="card stat">
        <div class="label">ë¬¸í•­</div>
        <div class="value"><span id="qNow">1</span>/<span id="qTotal">10</span></div>
      </div>
      <div class="card stat">
        <div class="label">ì ìˆ˜</div>
        <div class="value"><span id="score">0</span></div>
      </div>
    </div>

    <div class="card">
      <div class="hint">ì§ˆë³‘/ìƒí™©ì„ ë³´ê³  í•„ìš”í•œ PPE 1ê°œë¥¼ ê³ ë¥´ì„¸ìš”</div>
      <div class="hintSub">
        â‘  ì§ˆë³‘ëª…ì´ ë°•ìŠ¤ ì•ˆì—ì„œ ì•„ë˜ë¡œ <b>5ì´ˆ</b> ë™ì•ˆ ë‚´ë ¤ì˜µë‹ˆë‹¤(ì‹œê°„ ì´ˆê³¼ ì‹œ ì˜¤ë‹µ).<br/>
        â‘¡ ì•„ë˜ì—ì„œ PPE 1ê°œë¥¼ ëˆ„ë¥´ë©´ ìë™ ì±„ì  í›„ <b>ìë™ìœ¼ë¡œ</b> ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.
      </div>
    </div>

    <div class="statusRow">
      <div class="card pill">
        <div class="left">â³ ì œí•œì‹œê°„</div>
        <div class="right"><span id="timeLeft">5.0</span>s</div>
      </div>
      <div class="card pill">
        <div class="left">ìƒíƒœ</div>
        <div class="right"><span id="state">ì§„í–‰</span></div>
      </div>
    </div>

    <div class="stage" id="stage">
      <div class="fall" id="fallText">ë¡œë”©â€¦</div>
      <div class="badge good" id="badgeGood">ì •ë‹µ âœ“</div>
      <div class="badge bad"  id="badgeBad">ì˜¤ë‹µ âœ•</div>
    </div>

    <div class="ppeBox">
      <div class="ppeHead">
        <div class="h1">ë³´í˜¸êµ¬ ì„ íƒ (4ê°œ)</div>
        <div class="h2">í•œ ë¬¸ì œë‹¹ 1ê°œë§Œ ì„ íƒ</div>
      </div>
      <div class="grid">
        <div class="btn" data-pick="mask">
          <div class="b1">ë§ˆìŠ¤í¬</div>
          <div class="b2">ê¸°ë³¸(ë¹„ë§/ë¶„ë¬´)</div>
        </div>
        <div class="btn" data-pick="n95">
          <div class="b1">N95 ë§ˆìŠ¤í¬</div>
          <div class="b2">ê³µê¸°(ê²°í•µ ë“±)</div>
        </div>
        <div class="btn" data-pick="gown">
          <div class="b1">ê°€ìš´+ì¥ê°‘</div>
          <div class="b2">ì ‘ì´‰(ì˜¤ì—¼ë¬¼ ì²˜ë¦¬)</div>
        </div>
        <div class="btn" data-pick="none">
          <div class="b1">PPE ë¶ˆí•„ìš”</div>
          <div class="b2">ìœ„í—˜ ë‚®ìŒ(êµìœ¡ìš©)</div>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  // ====== ë¬¸ì œ ë°ì´í„° (í•„ìš”í•˜ë©´ ì—¬ê¸°ë§Œ ë°”ê¾¸ë©´ ë¨) ======
  const questions = [
    { text: "ì¸í”Œë£¨ì—”ì í™˜ì êµ¬ì—­ ì²­ì†Œ", answer: "mask" },
    { text: "ê²°í•µ ë³‘ì‹¤ ì²­ì†Œ", answer: "n95" },
    { text: "VRE/CRE ì¥ê¸° ì¬ì‹¤ ë³‘ì‹¤ í‡´ì‹¤ í›„ ì²­ì†Œ", answer: "gown" },
    { text: "ì˜¤ì—¼ëœ í˜ˆì•¡/ì²´ì•¡(ì†ŒëŸ‰) ì²˜ë¦¬", answer: "gown" },
    { text: "êµìœ¡ìš©(ì˜¤ì—¼ ì—†ìŒ) í™˜ê²½ ì ê²€", answer: "none" },
    { text: "ë…¸ë¡œë°”ì´ëŸ¬ìŠ¤ ì˜ì‹¬ êµ¬ì—­ ì²­ì†Œ", answer: "gown" },
    { text: "í™ì—­ í™˜ì ë™ì„  ì²­ì†Œ", answer: "n95" },
    { text: "ì½”ë¡œë‚˜19 í™˜ì êµ¬ì—­ ì²­ì†Œ", answer: "mask" },
    { text: "ê·  ë¯¸ê²€ì¶œ ì¼ë°˜ êµ¬ì—­ ë°”ë‹¥ ì²­ì†Œ", answer: "none" },
    { text: "ê²©ë¦¬ë³‘ì‹¤ í‡´ì‹¤ í›„ í™˜ê²½ ì†Œë…", answer: "gown" },
  ];

  // ====== ì„¤ì • ======
  const FALL_SECONDS = 5.0;           // 5ì´ˆ ë™ì•ˆ ë‚´ë ¤ì˜¤ê²Œ
  const AFTER_PICK_DELAY = 650;       // ì •ë‹µ/ì˜¤ë‹µ í‘œì‹œ í›„ ë‹¤ìŒë¬¸ì œê¹Œì§€ ë”œë ˆì´
  const NEXT_DELAY = 450;             // ì‹œê°„ì´ˆê³¼ ì˜¤ë‹µ í›„ ë‹¤ìŒë¬¸ì œ ë”œë ˆì´

  // ====== ì—˜ë¦¬ë¨¼íŠ¸ ======
  const qNowEl = document.getElementById("qNow");
  const qTotalEl = document.getElementById("qTotal");
  const scoreEl = document.getElementById("score");
  const timeEl = document.getElementById("timeLeft");
  const stateEl = document.getElementById("state");
  const stage = document.getElementById("stage");
  const fallEl = document.getElementById("fallText");
  const badgeGood = document.getElementById("badgeGood");
  const badgeBad  = document.getElementById("badgeBad");
  const restartBtn = document.getElementById("restartBtn");

  qTotalEl.textContent = String(questions.length);

  // ====== ìƒíƒœ ======
  let idx = 0;
  let score = 0;
  let running = false;
  let picked = false;
  let rafId = null;
  let startMs = 0;

  // ìŠ¤í…Œì´ì§€ì—ì„œ ë‚´ë ¤ì˜¤ëŠ” ë ìœ„ì¹˜ë¥¼ "ìŠ¤í…Œì´ì§€ ì•ˆì—ì„œë§Œ" ê³„ì‚°
  function getEndTop() {
    const stageH = stage.clientHeight;
    const boxH = fallEl.offsetHeight || 60;
    // ë°•ìŠ¤ê°€ ë°”ë‹¥ì— ë‹¿ê¸° ì „ì— ë©ˆì¶”ê²Œ (ì—¬ìœ  12px)
    return Math.max(12, stageH - boxH - 12);
  }

  function hideBadges(){
    badgeGood.style.display = "none";
    badgeBad.style.display = "none";
  }

  function setState(t){ stateEl.textContent = t; }

  function startQuestion() {
    if (idx >= questions.length) {
      // ë: ìƒíƒœ ì™„ë£Œ + ì¬ì‹œì‘ë§Œ
      setState("ì™„ë£Œ");
      fallEl.textContent = "ë! ì¬ì‹œì‘ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”";
      fallEl.style.top = "40%";
      timeEl.textContent = "0.0";
      running = false;
      return;
    }

    hideBadges();
    picked = false;
    running = true;

    qNowEl.textContent = String(idx + 1);
    setState("ì§„í–‰");

    // í…ìŠ¤íŠ¸ ì„¤ì •
    fallEl.textContent = questions[idx].text;

    // ì‹œì‘ ìœ„ì¹˜
    fallEl.style.top = "-90px";
    startMs = performance.now();

    // ì• ë‹ˆë©”ì´ì…˜
    const endTop = getEndTop();

    const tick = (now) => {
      if (!running) return;

      const t = (now - startMs) / (FALL_SECONDS * 1000);
      const clamped = Math.min(1, Math.max(0, t));

      // ë‚´ë ¤ì˜¤ëŠ” ìœ„ì¹˜
      const top = (-90) + (endTop + 90) * clamped;
      fallEl.style.top = top + "px";

      // ë‚¨ì€ ì‹œê°„
      const left = Math.max(0, FALL_SECONDS - (now - startMs) / 1000);
      timeEl.textContent = left.toFixed(1);

      // ì‹œê°„ ì´ˆê³¼
      if (clamped >= 1 && !picked) {
        picked = true;
        running = false;
        setState("ì˜¤ë‹µ");
        badgeBad.style.display = "inline-block";
        // ìë™ ë‹¤ìŒë¬¸ì œ
        setTimeout(() => {
          idx++;
          startQuestion();
        }, NEXT_DELAY);
        return;
      }

      rafId = requestAnimationFrame(tick);
    };

    if (rafId) cancelAnimationFrame(rafId);
    rafId = requestAnimationFrame(tick);
  }

  function pick(choice){
    if (!running || picked) return;

    picked = true;
    running = false;

    const ok = (choice === questions[idx].answer);

    if (ok) {
      score++;
      scoreEl.textContent = String(score);
      setState("ì •ë‹µ");
      badgeGood.style.display = "inline-block";
    } else {
      setState("ì˜¤ë‹µ");
      badgeBad.style.display = "inline-block";
    }

    // ìë™ ë‹¤ìŒ ë¬¸ì œ
    setTimeout(() => {
      idx++;
      startQuestion();
    }, AFTER_PICK_DELAY);
  }

  // ë²„íŠ¼ í´ë¦­ ì—°ê²°
  document.querySelectorAll(".btn").forEach(b => {
    b.addEventListener("click", () => pick(b.dataset.pick));
  });

  // ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ìŠ¤í…Œì´ì§€ ë ìœ„ì¹˜ ë‹¤ì‹œ ë°˜ì˜(ê¸€ì”¨ ì˜ë¦¼ ë°©ì§€)
  window.addEventListener("resize", () => {
    if (!running) return;
    // í˜„ì¬ ì§„í–‰ ì¤‘ì´ë©´, ì‹œì‘ ì‹œê°„ì„ ì¬ì„¤ì •í•˜ì§€ ì•Šê³  ìœ„ì¹˜ë§Œ ë¶€ë“œëŸ½ê²Œ ìœ ì§€
    // ë‹¤ìŒ í”„ë ˆì„ì—ì„œ getEndTop()ì´ ìƒˆ ë†’ì´ì— ë§ê²Œ ê³„ì‚°ë¨
  });

  restartBtn.addEventListener("click", () => location.reload());

  // ì‹œì‘ ë²„íŠ¼ ì—†ì´ ìë™ ì‹œì‘
  startQuestion();
})();
</script>
</body>
</html>
