<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PPE 교육 퀴즈</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:rgba(255,255,255,.08);
      --card2:rgba(255,255,255,.12);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.72);
      --good:#22c55e;
      --bad:#ef4444;
      --accent:#7c3aed;
      --stroke:rgba(255,255,255,.14);
      --radius:22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background: radial-gradient(1200px 800px at 50% -10%, #1a2450 0%, var(--bg) 55%, #070a14 100%);
      color:var(--text);
      font-family: system-ui, -apple-system, "Pretendard", "Noto Sans KR", sans-serif;
      display:flex;
      min-height:100vh;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .app{
      width:min(560px, 100%);
    }
    .topbar{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
    }
    .pill{
      background:rgba(255,255,255,.08);
      border:1px solid var(--stroke);
      padding:8px 12px;
      border-radius:999px;
      font-weight:700;
      letter-spacing:-.2px;
    }
    .pill small{color:var(--muted); font-weight:600}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      padding:18px;
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
    }
    h1{
      margin:0 0 8px;
      font-size:22px;
      letter-spacing:-.5px;
    }
    .sub{
      margin:0 0 14px;
      color:var(--muted);
      font-weight:600;
      line-height:1.45;
    }
    .avatarWrap{
      background:rgba(255,255,255,.06);
      border:1px solid var(--stroke);
      border-radius:20px;
      padding:16px;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:230px;
      margin:14px 0 14px;
    }
    .avatar{
      width:min(240px, 78%);
      height:auto;
      image-rendering:auto;
      filter: drop-shadow(0 14px 18px rgba(0,0,0,.35));
      user-select:none;
      -webkit-user-drag:none;
    }
    .grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:10px;
    }
    button.opt{
      border:none;
      border-radius:18px;
      padding:14px 14px;
      text-align:left;
      color:var(--text);
      background:rgba(255,255,255,.07);
      border:1px solid var(--stroke);
      font-weight:800;
      letter-spacing:-.2px;
      display:flex;
      flex-direction:column;
      gap:6px;
      min-height:74px;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
    }
    button.opt span{
      font-size:12px;
      color:var(--muted);
      font-weight:700;
    }
    button.opt:active{transform:scale(.98)}
    button.opt.correct{
      border-color:rgba(34,197,94,.55);
      background:rgba(34,197,94,.12);
    }
    button.opt.wrong{
      border-color:rgba(239,68,68,.55);
      background:rgba(239,68,68,.12);
    }
    .footer{
      margin-top:14px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .msg{
      min-height:22px;
      color:var(--muted);
      font-weight:700;
    }
    .actions{
      display:flex;
      gap:10px;
      width:100%;
    }
    .btn{
      flex:1;
      border:none;
      border-radius:16px;
      padding:14px 14px;
      font-weight:900;
      letter-spacing:-.2px;
      color:var(--text);
      background:rgba(255,255,255,.08);
      border:1px solid var(--stroke);
    }
    .btn.primary{
      background:linear-gradient(180deg, rgba(124,58,237,.95), rgba(124,58,237,.75));
      border-color:rgba(124,58,237,.55);
    }
    .hint{
      margin-top:10px;
      color:rgba(234,240,255,.55);
      font-size:12px;
      font-weight:650;
      line-height:1.45;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="topbar">
      <div class="pill">문항: <span id="qIndex">1</span>/<span id="qTotal">1</span></div>
      <div class="pill">점수: <span id="score">0</span> <small>(정답 +1)</small></div>
    </div>

    <div class="card">
      <h1 id="title">PPE 교육 퀴즈</h1>
      <p class="sub" id="desc">상황을 보고 적절한 격리/보호구를 선택하세요.</p>

      <div class="avatarWrap">
        <img id="avatar" class="avatar" src="assets/idle.png" alt="캐릭터" />
      </div>

      <div class="grid" id="options"></div>

      <div class="footer">
        <div class="msg" id="msg"></div>
        <div class="actions">
          <button class="btn" id="resetBtn">처음으로</button>
          <button class="btn primary" id="nextBtn">다음</button>
        </div>
      </div>

      <div class="hint">
        ※ 이 페이지는 <b>교육용(테스트)</b> 입니다. 문항/정답은 감염관리실 기준에 맞게 언제든 교체 가능합니다.
      </div>
    </div>
  </div>

  <script>
    // ✅ 문항만 여기서 바꾸면 됨
    // correctIndex: 0~3 (보기 4개 기준)
    const questions = [
      {
        title: "수두(Varicella) 의심 환자",
        desc: "공기 전파 + 접촉 전파. 격리주의는?",
        options: [
          { label: "비말주의", sub: "침방울" },
          { label: "공기주의", sub: "에어로졸" },
          { label: "접촉주의", sub: "접촉/환경" },
          { label: "표준주의", sub: "기본" },
        ],
        correctIndex: 1,
        explain: "수두/파종성 대상포진은 공기주의(그리고 접촉주의 병행)를 고려합니다."
      },
      {
        title: "결핵 의심 환자 객담 유도/기관흡인",
        desc: "에어로졸 발생 처치. 필요한 마스크는?",
        options: [
          { label: "수술마스크", sub: "비말" },
          { label: "KF94/N95", sub: "공기주의" },
          { label: "마스크 불필요", sub: "해당 없음" },
          { label: "천 마스크", sub: "비권장" },
        ],
        correctIndex: 1,
        explain: "결핵 의심 + 에어로졸 처치 시 호흡보호구(KF94/N95 등)가 필요합니다."
      },
      {
        title: "혈액/체액 튈 가능성 있는 처치",
        desc: "눈/얼굴 보호가 필요한 상황. 무엇을 추가?",
        options: [
          { label: "보안경/페이스쉴드", sub: "튀김 보호" },
          { label: "모자만", sub: "제한적" },
          { label: "덧신만", sub: "불충분" },
          { label: "아무것도", sub: "오염 위험" },
        ],
        correctIndex: 0,
        explain: "혈액/체액 튐 위험이 있으면 보안경/페이스쉴드 등 점막 보호가 필요합니다."
      },
      {
        title: "환자 활력징후 측정(체액 노출 없음)",
        desc: "일반적인 접촉 최소. PPE는?",
        options: [
          { label: "장갑", sub: "체액/접촉" },
          { label: "가운", sub: "오염/접촉" },
          { label: "N95", sub: "공기주의" },
          { label: "PPE 불필요", sub: "손위생 중심" },
        ],
        correctIndex: 3,
        explain: "체액 노출 위험이 없다면 표준주의(손위생)가 핵심이며, 상황에 따라 PPE를 추가합니다."
      }
    ];

    const els = {
      qIndex: document.getElementById("qIndex"),
      qTotal: document.getElementById("qTotal"),
      score: document.getElementById("score"),
      title: document.getElementById("title"),
      desc: document.getElementById("desc"),
      options: document.getElementById("options"),
      msg: document.getElementById("msg"),
      avatar: document.getElementById("avatar"),
      nextBtn: document.getElementById("nextBtn"),
      resetBtn: document.getElementById("resetBtn"),
    };

    const SPRITES = {
      idle: "assets/idle.png",
      correct: "assets/correct.png",
      wrong: "assets/wrong.png",
    };

    let idx = 0;
    let score = 0;
    let locked = false;

    els.qTotal.textContent = questions.length;

    function render(){
      locked = false;
      const q = questions[idx];
      els.qIndex.textContent = (idx + 1);
      els.title.textContent = q.title;
      els.desc.textContent = q.desc;
      els.msg.textContent = "";
      els.avatar.src = SPRITES.idle;

      els.options.innerHTML = "";
      q.options.forEach((opt, i) => {
        const b = document.createElement("button");
        b.className = "opt";
        b.innerHTML = `${opt.label}<span>${opt.sub || ""}</span>`;
        b.addEventListener("click", () => choose(i, b));
        els.options.appendChild(b);
      });

      els.nextBtn.textContent = (idx === questions.length - 1) ? "결과 보기" : "다음";
    }

    function choose(chosenIndex, btn){
      if (locked) return;
      locked = true;

      const q = questions[idx];
      const buttons = Array.from(els.options.querySelectorAll("button.opt"));

      // 정답/오답 표시
      buttons.forEach((b, i) => {
        if (i === q.correctIndex) b.classList.add("correct");
      });
      if (chosenIndex !== q.correctIndex) btn.classList.add("wrong");

      if (chosenIndex === q.correctIndex){
        score += 1;
        els.score.textContent = score;
        els.avatar.src = SPRITES.correct;
        els.msg.style.color = "rgba(34,197,94,.95)";
        els.msg.textContent = "정답! " + q.explain;
      } else {
        els.avatar.src = SPRITES.wrong;
        els.msg.style.color = "rgba(239,68,68,.95)";
        els.msg.textContent = "오답! " + q.explain;
      }
    }

    function next(){
      if (idx < questions.length - 1){
        idx += 1;
        render();
      } else {
        // 마지막: 결과 화면(간단)
        els.title.textContent = "학습 결과";
        els.desc.textContent = "수고하셨어요! 아래는 이번 점수입니다.";
        els.options.innerHTML = "";
        els.avatar.src = (score === questions.length) ? SPRITES.correct : SPRITES.idle;
        els.msg.style.color = "rgba(234,240,255,.85)";
        els.msg.textContent = `총 ${questions.length}문항 중 ${score}문항 정답`;
        els.nextBtn.textContent = "처음으로";
        locked = true;
      }
    }

    function reset(){
      idx = 0;
      score = 0;
      els.score.textContent = score;
      els.nextBtn.textContent = "다음";
      render();
    }

    els.nextBtn.addEventListener("click", () => {
      // 결과 보기 화면에서 "처음으로" 역할
      if (els.nextBtn.textContent === "처음으로") reset();
      else next();
    });
    els.resetBtn.addEventListener("click", reset);

    // 이미지 경로 체크(파일명 틀리면 여기서 깨짐)
    window.addEventListener("error", (e) => {
      // 조용히 두되, 이미지가 안 뜰 때 원인 찾기용
      // console.log(e);
    });

    render();
  </script>
</body>
</html>
