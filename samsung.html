<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>í™”ìˆœì „ë‚¨ëŒ€ë³‘ì› ê°ì—¼ê´€ë¦¬ êµìœ¡</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.14);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.75);
      --good:#22c55e;
      --bad:#ef4444;
      --accent:#7c3aed;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Pretendard", "Noto Sans KR", sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 520px at 50% -10%, rgba(124,58,237,.35), transparent 55%),
        radial-gradient(900px 520px at 50% 110%, rgba(59,130,246,.18), transparent 55%),
        linear-gradient(180deg, #070a14, var(--bg));
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:16px 12px 22px;
    }
    .wrap{width:min(760px, 100%)}
    .top{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      margin-bottom:12px;
      flex-wrap:wrap;
    }
    .brand{
      font-weight:900;
      letter-spacing:-.4px;
      font-size:16px;
      padding:10px 12px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--stroke);
      border-radius:999px;
    }
    .pill{
      padding:10px 12px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--stroke);
      border-radius:999px;
      font-weight:800;
      color:var(--muted);
    }
    .pill b{color:var(--text)}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      border-radius:22px;
      padding:16px;
      box-shadow:0 18px 40px rgba(0,0,0,.35);
    }
    h1{
      margin:0 0 6px;
      font-size:20px;
      letter-spacing:-.4px;
    }
    .sub{
      margin:0 0 12px;
      color:var(--muted);
      font-size:14px;
      line-height:1.45;
    }
    .scenario{
      margin:12px 0 14px;
      padding:14px;
      background:rgba(0,0,0,.12);
      border:1px solid rgba(255,255,255,.12);
      border-radius:18px;
    }
    .scenario .tag{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--muted);
      font-size:12px;
      font-weight:800;
      margin-bottom:10px;
    }
    .scenario .title{
      font-weight:900;
      font-size:18px;
      margin:0 0 6px;
    }
    .scenario .desc{
      margin:0;
      color:var(--muted);
      font-size:14px;
      line-height:1.45;
    }

    .sectionTitle{
      margin:12px 0 8px;
      font-weight:900;
      letter-spacing:-.2px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .grid{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:10px;
    }
    .opt{
      width:100%;
      border-radius:16px;
      padding:12px 12px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      font-weight:900;
      font-size:15px;
      text-align:left;
      cursor:pointer;
      user-select:none;
      display:flex;
      justify-content:space-between;
      align-items:center;
      min-height:58px;
    }
    .opt small{
      color:var(--muted);
      font-weight:700;
      font-size:12px;
    }
    .opt.on{
      outline:2px solid rgba(124,58,237,.65);
      background:rgba(124,58,237,.16);
    }
    .opt.disabled{
      opacity:.55;
      pointer-events:none;
    }
    .row{
      display:flex;
      gap:10px;
      margin-top:12px;
    }
    .btn{
      flex:1;
      border:none;
      border-radius:16px;
      padding:13px 14px;
      font-weight:900;
      font-size:16px;
      cursor:pointer;
      color:var(--text);
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
    }
    .btn.primary{
      background:linear-gradient(180deg, rgba(139,92,246,.95), rgba(109,40,217,.85));
      border-color:rgba(139,92,246,.45);
    }
    .btn:disabled{opacity:.55; cursor:not-allowed}

    .feedback{
      margin-top:12px;
      padding:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.12);
      display:none;
    }
    .feedback.good{border-color:rgba(34,197,94,.35)}
    .feedback.bad{border-color:rgba(239,68,68,.35)}
    .feedback .headline{
      font-weight:1000;
      margin:0 0 6px;
      letter-spacing:-.2px;
    }
    .feedback .body{
      margin:0;
      color:var(--muted);
      line-height:1.5;
      white-space:pre-line;
      font-size:14px;
    }
    .note{
      margin-top:10px;
      color:rgba(234,240,255,.55);
      font-size:12px;
      line-height:1.45;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">í™”ìˆœì „ë‚¨ëŒ€í•™êµë³‘ì› ê°ì—¼ê´€ë¦¬ êµìœ¡ Â· 73ë³‘ë™</div>
      <div class="pill">ë¬¸í•­ <b id="qNo">1</b>/<b id="qTotal">10</b></div>
      <div class="pill">ì ìˆ˜ <b id="score">0</b></div>
    </div>

    <div class="card">
      <h1>ê²©ë¦¬ì£¼ì˜ + PPE ì„ íƒ í€´ì¦ˆ</h1>
      <p class="sub">ìƒí™©ì„ ë³´ê³  <b>ê²©ë¦¬ì£¼ì˜(1ê°œ)</b>ë¥¼ ì„ íƒí•˜ê³ , í•„ìš”í•œ <b>PPE(ì—¬ëŸ¬ ê°œ)</b>ë¥¼ ì²´í¬í•œ ë’¤ ì œì¶œí•˜ì„¸ìš”.</p>

      <div class="scenario">
        <div class="tag" id="tag">ğŸ§© ìƒí™©</div>
        <p class="title" id="title">ë¡œë”©ì¤‘...</p>
        <p class="desc" id="desc"></p>
      </div>

      <div class="sectionTitle">ğŸ›‘ ê²©ë¦¬ì£¼ì˜ (1ê°œ ì„ íƒ)</div>
      <div class="grid" id="isoGrid"></div>

      <div class="sectionTitle">ğŸ§¤ PPE (ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥)</div>
      <div class="grid" id="ppeGrid"></div>

      <div class="row">
        <button class="btn" id="resetBtn">ì²˜ìŒìœ¼ë¡œ</button>
        <button class="btn primary" id="submitBtn">ì œì¶œ</button>
        <button class="btn primary" id="nextBtn" disabled>ë‹¤ìŒ</button>
      </div>

      <div class="feedback" id="fb">
        <div class="headline" id="fbHead"></div>
        <p class="body" id="fbBody"></p>
      </div>

      <div class="note">
        â€» ë³¸ í€´ì¦ˆëŠ” êµìœ¡ìš©(í…ŒìŠ¤íŠ¸)ì…ë‹ˆë‹¤. ê¸°ê´€/ë¶€ì„œ ë°©ì¹¨ ë° ìµœì‹  ì§€ì¹¨ì— ë”°ë¼ ë¬¸í•­ì€ ì¡°ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </div>
    </div>
  </div>

<script>
  // ====== ë³´ê¸° ëª©ë¡ ======
  const ISO_OPTIONS = [
    {key:"standard", label:"í‘œì¤€ì£¼ì˜", hint:"ì†ìœ„ìƒ ê¸°ë³¸"},
    {key:"contact",  label:"ì ‘ì´‰ì£¼ì˜", hint:"ì ‘ì´‰/í™˜ê²½"},
    {key:"droplet",  label:"ë¹„ë§ì£¼ì˜", hint:"ì¹¨ë°©ìš¸"},
    {key:"airborne", label:"ê³µê¸°ì£¼ì˜", hint:"ì—ì–´ë¡œì¡¸"},
    {key:"air+contact", label:"ê³µê¸°+ì ‘ì´‰", hint:"ë™ì‹œ ì ìš©"}
  ];

  const PPE_OPTIONS = [
    {key:"none", label:"PPE ë¶ˆí•„ìš”", hint:"ìƒí™© í™•ì¸"},
    {key:"gloves", label:"ì¥ê°‘", hint:"ì²´ì•¡/ì ‘ì´‰"},
    {key:"gown", label:"ê°€ìš´", hint:"ì˜¤ì—¼/ì ‘ì´‰"},
    {key:"surgmask", label:"ìˆ˜ìˆ ë§ˆìŠ¤í¬", hint:"ë¹„ë§"},
    {key:"n95", label:"N95/KF94", hint:"ê³µê¸°"},
    {key:"eye", label:"ë³´ì•ˆê²½/í˜ì´ìŠ¤ì‰´ë“œ", hint:"íŠ ìœ„í—˜"},
  ];

  // ====== 10ë¬¸í•­ (ì‹¤ì œ ê°ì—¼ê´€ë¦¬ êµìœ¡ ìˆ˜ì¤€) ======
  // ì •ë‹µì€ "iso" 1ê°œ + "ppe" ì—¬ëŸ¬ê°œ(ë°°ì—´)
  const QUESTIONS = [
    {
      tag:"ğŸ« í˜¸í¡ê¸°",
      title:"ê²°í•µ ì˜ì‹¬ í™˜ì: ê°ë‹´ ìœ ë„/ê¸°ê´€í¡ì¸(ì—ì–´ë¡œì¡¸ ë°œìƒ)",
      desc:"ê²€ì‚¬/ì²˜ì¹˜ ì¤‘ ê¸°ì¹¨ ìœ ë°œ, ì—ì–´ë¡œì¡¸ ë…¸ì¶œ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤.",
      iso:"airborne",
      ppe:["n95"],
      explain:"ê²°í•µ ì˜ì‹¬ + ì—ì–´ë¡œì¡¸ ë°œìƒ ì²˜ì¹˜ëŠ” ê³µê¸°ì£¼ì˜(ìš°ì„ )ë¡œ ì ‘ê·¼í•©ë‹ˆë‹¤.\ní˜¸í¡ë³´í˜¸êµ¬(N95/KF94 ë“±) ì°©ìš©ì´ í•„ìš”í•©ë‹ˆë‹¤."
    },
    {
      tag:"ğŸ¦  ë°”ì´ëŸ¬ìŠ¤",
      title:"ìˆ˜ë‘(Varicella) ì˜ì‹¬ í™˜ì: ì „ì‹  ë°œì§„ + ê°€ë ¤ì›€",
      desc:"ê³µê¸° ì „íŒŒ + ì ‘ì´‰ ì „íŒŒ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.",
      iso:"air+contact",
      ppe:["n95","gown","gloves"],
      explain:"ìˆ˜ë‘/íŒŒì¢…ì„± ëŒ€ìƒí¬ì§„ ì˜ì‹¬ ì‹œ ê³µê¸°ì£¼ì˜ + ì ‘ì´‰ì£¼ì˜ ë³‘í–‰ì„ ê³ ë ¤í•©ë‹ˆë‹¤.\nPPEëŠ” N95/KF94 + ê°€ìš´ + ì¥ê°‘ì´ ê¸°ë³¸ì…ë‹ˆë‹¤."
    },
    {
      tag:"ğŸ’© ì¥ê´€ê°ì—¼",
      title:"C. difficile ì„¤ì‚¬ í™˜ì ëŒë´„",
      desc:"í™˜ê²½ ì˜¤ì—¼ ë° ì ‘ì´‰ ì „íŒŒ ìœ„í—˜ì´ í½ë‹ˆë‹¤.",
      iso:"contact",
      ppe:["gown","gloves"],
      explain:"C. difficile ì˜ì‹¬/í™•ì§„ í™˜ì ëŒë´„ì€ ì ‘ì´‰ì£¼ì˜ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.\nê°€ìš´+ì¥ê°‘ì„ ì°©ìš©í•˜ê³  ì†ìœ„ìƒ(ìƒí™©ì— ë”°ë¼ ë¹„ëˆ„/ë¬¼)ì„ ì² ì €íˆ í•©ë‹ˆë‹¤."
    },
    {
      tag:"ğŸ§ª ë‹¤ì œë‚´ì„±ê· ",
      title:"CRE/VRE ë³´ê·  ë˜ëŠ” ê°ì—¼ í™˜ì(ì¥ê¸° ì¬ì›)",
      desc:"ì ‘ì´‰/í™˜ê²½ì„ í†µí•œ ì „íŒŒ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤.",
      iso:"contact",
      ppe:["gown","gloves"],
      explain:"CRE/VRE ë“± ë‹¤ì œë‚´ì„±ê· ì€ ì ‘ì´‰ì£¼ì˜ ê¸°ë°˜ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.\ní™˜ìÂ·í™˜ê²½ ì ‘ì´‰ ì‹œ ê°€ìš´+ì¥ê°‘ì„ ì ìš©í•©ë‹ˆë‹¤."
    },
    {
      tag:"ğŸ˜· í˜¸í¡ê¸°",
      title:"ì¸í”Œë£¨ì—”ì ì˜ì‹¬ í™˜ì: ë°œì—´+ê¸°ì¹¨, ì¹¨ë°©ìš¸ ì „íŒŒ",
      desc:"ê·¼ì ‘ ì ‘ì´‰ìœ¼ë¡œ ë¹„ë§ ë…¸ì¶œ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.",
      iso:"droplet",
      ppe:["surgmask"],
      explain:"ì¸í”Œë£¨ì—”ì ë“± ë¹„ë§ì£¼ì˜ ìƒí™©ì—ì„œëŠ” ìˆ˜ìˆ ë§ˆìŠ¤í¬ ì°©ìš©ì´ ê¸°ë³¸ì…ë‹ˆë‹¤.\nì²´ì•¡/ë¶„ë¹„ë¬¼ ì ‘ì´‰ ê°€ëŠ¥ ì‹œ ì¥ê°‘/ê°€ìš´ì€ ì¶”ê°€ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
    },
    {
      tag:"ğŸ¤’ í˜¸í¡ê¸°",
      title:"í˜¸í¡ê¸° ì¦ìƒ í™˜ì ì¼ë°˜ ì§„ë£Œ(ë¹„ë§ ë…¸ì¶œ ê°€ëŠ¥)",
      desc:"ê¸°ì¹¨Â·ì¬ì±„ê¸° ê·¼ì ‘ ë…¸ì¶œì´ ì˜ˆìƒë©ë‹ˆë‹¤.",
      iso:"droplet",
      ppe:["surgmask"],
      explain:"ë¹„ë§ ë…¸ì¶œ ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë©´ ë¹„ë§ì£¼ì˜ ìˆ˜ì¤€ì˜ ë§ˆìŠ¤í¬ ì°©ìš©ì´ ê¸°ë³¸ì…ë‹ˆë‹¤.\ní™˜ì ìƒíƒœ/ì²˜ì¹˜ì— ë”°ë¼ PPEë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤."
    },
    {
      tag:"ğŸ©¸ ë…¸ì¶œ ìœ„í—˜",
      title:"í˜ˆì•¡/ì²´ì•¡ íŠ ìœ„í—˜ì´ ìˆëŠ” ì²˜ì¹˜(í¡ì¸/ë°°ì•¡/ì„¸ì²™ ë“±)",
      desc:"ì ë§‰(ëˆˆ/ì½”/ì…)ìœ¼ë¡œ íŠ ë…¸ì¶œ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.",
      iso:"standard",
      ppe:["eye","gloves","gown"],
      explain:"í‘œì¤€ì£¼ì˜ ìƒí™©ì—ì„œë„ 'íŠ ìœ„í—˜'ì´ ìˆìœ¼ë©´ ë³´ì•ˆê²½/í˜ì´ìŠ¤ì‰´ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤.\nì¥ê°‘+ê°€ìš´ì€ ì˜¤ì—¼ ê°€ëŠ¥ì„±ì— ë”°ë¼ í•¨ê»˜ ì ìš©í•©ë‹ˆë‹¤."
    },
    {
      tag:"ğŸ§¼ ì¼ë°˜",
      title:"í™œë ¥ì§•í›„ ì¸¡ì •(ì²´ì•¡ ë…¸ì¶œ ì—†ìŒ, ì ‘ì´‰ ìµœì†Œ)",
      desc:"í”¼ë¶€ ì†ìƒ/ì²´ì•¡ ë…¸ì¶œ ìœ„í—˜ì´ ì—†ëŠ” ìƒí™©ì…ë‹ˆë‹¤.",
      iso:"standard",
      ppe:["none"],
      explain:"í‘œì¤€ì£¼ì˜ì˜ í•µì‹¬ì€ ì†ìœ„ìƒì…ë‹ˆë‹¤.\nì²´ì•¡ ë…¸ì¶œ ìœ„í—˜ì´ ì—†ë‹¤ë©´ PPE ì—†ì´ ì†ìœ„ìƒ ì¤‘ì‹¬ìœ¼ë¡œ ìˆ˜í–‰í•©ë‹ˆë‹¤."
    },
    {
      tag:"ğŸ¦  MRSA",
      title:"MRSA ìƒì²˜ ë“œë ˆì‹± êµí™˜",
      desc:"ìƒì²˜ ë¶„ë¹„ë¬¼ ì ‘ì´‰ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.",
      iso:"contact",
      ppe:["gloves","gown"],
      explain:"ìƒì²˜ ë¶„ë¹„ë¬¼ ì ‘ì´‰ ê°€ëŠ¥ì„±ì´ í¬ë©´ ì ‘ì´‰ì£¼ì˜ ìˆ˜ì¤€ìœ¼ë¡œ ê°€ìš´+ì¥ê°‘ì„ ê³ ë ¤í•©ë‹ˆë‹¤.\nìƒí™©ì— ë”°ë¼ ë³´í˜¸êµ¬ëŠ” ì¶”ê°€ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
    },
    {
      tag:"ğŸ«§ ê³µê¸°/ë¹„ë§ í˜¼ë™ ì£¼ì˜",
      title:"í™ì—­ ì˜ì‹¬ í™˜ì: ë°œì§„ + ê³ ì—´ + ê¸°ì¹¨",
      desc:"ê³µê¸° ì „íŒŒ(ì—ì–´ë¡œì¡¸) ìœ„í—˜ì´ í½ë‹ˆë‹¤.",
      iso:"airborne",
      ppe:["n95"],
      explain:"í™ì—­ì€ ê³µê¸°ì£¼ì˜ ëŒ€ìƒì…ë‹ˆë‹¤.\ní˜¸í¡ë³´í˜¸êµ¬(N95/KF94 ë“±) ì°©ìš© ë° ê²©ë¦¬(ìŒì•• ë“±) ê³ ë ¤ê°€ í•„ìš”í•©ë‹ˆë‹¤."
    }
  ];

  // ====== ìƒíƒœ ======
  let idx = 0;
  let score = 0;
  let selectedIso = null;        // 1ê°œ
  let selectedPpe = new Set();   // ì—¬ëŸ¬ê°œ
  let locked = false;

  // ====== ì—˜ë¦¬ë¨¼íŠ¸ ======
  const qNo = document.getElementById("qNo");
  const qTotal = document.getElementById("qTotal");
  const scoreEl = document.getElementById("score");
  const tagEl = document.getElementById("tag");
  const titleEl = document.getElementById("title");
  const descEl = document.getElementById("desc");
  const isoGrid = document.getElementById("isoGrid");
  const ppeGrid = document.getElementById("ppeGrid");
  const submitBtn = document.getElementById("submitBtn");
  const nextBtn = document.getElementById("nextBtn");
  const resetBtn = document.getElementById("resetBtn");
  const fb = document.getElementById("fb");
  const fbHead = document.getElementById("fbHead");
  const fbBody = document.getElementById("fbBody");

  qTotal.textContent = String(QUESTIONS.length);

  // ====== UI ìƒì„± ======
  function buildOptions(){
    isoGrid.innerHTML = "";
    ISO_OPTIONS.forEach(opt=>{
      const b = document.createElement("button");
      b.className = "opt";
      b.type = "button";
      b.dataset.key = opt.key;
      b.innerHTML = `${opt.label} <small>${opt.hint}</small>`;
      b.onclick = () => {
        if(locked) return;
        selectedIso = opt.key;
        syncIso();
      };
      isoGrid.appendChild(b);
    });

    ppeGrid.innerHTML = "";
    PPE_OPTIONS.forEach(opt=>{
      const b = document.createElement("button");
      b.className = "opt";
      b.type = "button";
      b.dataset.key = opt.key;
      b.innerHTML = `${opt.label} <small>${opt.hint}</small>`;
      b.onclick = () => {
        if(locked) return;

        // PPE ë¶ˆí•„ìš”ëŠ” ë‹¨ë… ì„ íƒ
        if(opt.key === "none"){
          selectedPpe.clear();
          selectedPpe.add("none");
          syncPpe();
          return;
        }
        // ë‹¤ë¥¸ ê±¸ ê³ ë¥´ë©´ none í•´ì œ
        if(selectedPpe.has("none")) selectedPpe.delete("none");

        if(selectedPpe.has(opt.key)) selectedPpe.delete(opt.key);
        else selectedPpe.add(opt.key);
        syncPpe();
      };
      ppeGrid.appendChild(b);
    });
  }

  function syncIso(){
    [...isoGrid.querySelectorAll(".opt")].forEach(b=>{
      b.classList.toggle("on", b.dataset.key === selectedIso);
    });
  }

  function syncPpe(){
    [...ppeGrid.querySelectorAll(".opt")].forEach(b=>{
      b.classList.toggle("on", selectedPpe.has(b.dataset.key));
    });
  }

  function setLocked(v){
    locked = v;
    [...isoGrid.querySelectorAll(".opt")].forEach(b=>b.classList.toggle("disabled", v));
    [...ppeGrid.querySelectorAll(".opt")].forEach(b=>b.classList.toggle("disabled", v));
  }

  function normalizeSet(arr){
    return new Set(arr);
  }

  function setEqual(setA, arrB){
    const setB = normalizeSet(arrB);
    if(setA.size !== setB.size) return false;
    for(const v of setA) if(!setB.has(v)) return false;
    return true;
  }

  function labelMap(list){
    const m = new Map();
    list.forEach(x=>m.set(x.key, x.label));
    return m;
  }

  const isoLabel = labelMap(ISO_OPTIONS);
  const ppeLabel = labelMap(PPE_OPTIONS);

  function fmt(keys, map){
    return keys.map(k => map.get(k) || k).join(", ");
  }

  // ====== ë Œë” ======
  function render(){
    const q = QUESTIONS[idx];
    qNo.textContent = String(idx+1);
    scoreEl.textContent = String(score);

    tagEl.textContent = q.tag || "ğŸ§© ìƒí™©";
    titleEl.textContent = q.title;
    descEl.textContent = q.desc || "";

    selectedIso = null;
    selectedPpe.clear();

    syncIso();
    syncPpe();

    fb.style.display = "none";
    nextBtn.disabled = true;
    submitBtn.disabled = false;

    setLocked(false);
  }

  // ====== ì±„ì  ======
  function grade(){
    const q = QUESTIONS[idx];

    if(!selectedIso){
      alert("ê²©ë¦¬ì£¼ì˜ë¥¼ 1ê°œ ì„ íƒí•˜ì„¸ìš”.");
      return;
    }
    if(selectedPpe.size === 0){
      alert("PPEë¥¼ 1ê°œ ì´ìƒ ì„ íƒí•˜ì„¸ìš”.");
      return;
    }

    const isoOk = (selectedIso === q.iso);
    const ppeOk = setEqual(selectedPpe, q.ppe);

    const allOk = isoOk && ppeOk;

    if(allOk) score += 1;

    // í”¼ë“œë°± í‘œì‹œ
    fb.style.display = "block";
    fb.className = "feedback " + (allOk ? "good" : "bad");
    fbHead.textContent = allOk ? "ì •ë‹µ âœ… (ì ìˆ˜ +1)" : "ì˜¤ë‹µ âŒ";
    const myIso = isoLabel.get(selectedIso) || selectedIso;
    const myPpe = fmt([...selectedPpe], ppeLabel);

    const correctIso = isoLabel.get(q.iso) || q.iso;
    const correctPpe = fmt(q.ppe, ppeLabel);

    fbBody.textContent =
      `ë‚´ ì„ íƒ\n- ê²©ë¦¬ì£¼ì˜: ${myIso}\n- PPE: ${myPpe}\n\nì •ë‹µ\n- ê²©ë¦¬ì£¼ì˜: ${correctIso}\n- PPE: ${correctPpe}\n\ní•´ì„¤\n${q.explain}`;

    scoreEl.textContent = String(score);

    // ì ê¸ˆ + ë‹¤ìŒ ë²„íŠ¼
    setLocked(true);
    submitBtn.disabled = true;
    nextBtn.disabled = false;
  }

  function next(){
    if(idx < QUESTIONS.length - 1){
      idx += 1;
      render();
      return;
    }

    // ì¢…ë£Œ í™”ë©´
    tagEl.textContent = "ğŸ‰ ì™„ë£Œ";
    titleEl.textContent = "í•™ìŠµ ì™„ë£Œ";
    descEl.textContent = `ì´ ${QUESTIONS.length}ë¬¸í•­ ì¤‘ ${score}ì ì…ë‹ˆë‹¤. (ì§ì›êµìœ¡ìš© í…ŒìŠ¤íŠ¸)`;

    isoGrid.innerHTML = "";
    ppeGrid.innerHTML = "";

    fb.style.display = "none";
    submitBtn.disabled = true;
    nextBtn.disabled = true;
    setLocked(true);
  }

  function reset(){
    idx = 0;
    score = 0;
    render();
  }

  submitBtn.onclick = grade;
  nextBtn.onclick = next;
  resetBtn.onclick = reset;

  // ì‹œì‘
  buildOptions();
  render();
</script>
</body>
</html>
